#RL 

在上节课中，我们提到的“稳定性”是一种局部（或者说“渐进”）的稳定性。在这节课中，我们将继续介绍动力学系统，并讨论如何将连续的微分方程转化为在计算机中可以求解的离散的差分方程。此外，我们将继续讨论稳定性的相关内容。

## 连续系统的离散化
众所周知，不是所有的微分方程都具有解的结构，因此我们必须介绍计算机求解它们。因此，我们需要讨论微分方程的离散化。

### Explicit Form/显格式
显格式的离散化是下面这样的：
$$
x_{n+1} = f_{d} (x_{n},u_{n})
$$
例如，最简单的前向欧拉积分法：
$$
x_{n+1}  = x_{n} + h f(x_{n},u_{n})
$$
这种方法的危险是可能不能正确地收敛，而且常常造成错误积累。例如，当你在无阻尼的单摆上使用这种方法时，总是不能正确地收敛（直觉上，这是一阶近似造成的不良后果）

## 离散时间系统的稳定性
我们知道，在连续时间系统中，我们要求一个平衡点是渐近稳定的，那么需要此处的 Jacobian 矩阵的所有本征值均具有负的实部。那么，在离散系统中，我们的动力学系统实际上是通过迭代的映射得到的：
$$
x_{n} = f(f(f(\cdots )))
$$
因此，我们也将迭代地求解系统在此处的 Jacobian 矩阵（链式求导法则）：
$$
\frac{\partial x_{n}}{\partial \Delta x } = \frac{\partial f_{d}}{\partial x} \frac{\partial f_{d}}{\partial x}\cdots  = A_{d}^{n}
$$
（这 $n$ 次求导都是发生在平衡点附近的，因此我们可以将同样的矩阵连乘 $n$ 次）
假定我们重新设置了坐标，使得系统的平衡点被放到了 0 处，那么，对于系统的任意一个扰动 $\Delta x$，我们都有：
$$
\lim_{n \rightarrow \infty} A^{k} \Delta x = 0
$$
这意味着：
$$
\lim_{n \rightarrow \infty} A^{k} = 0
$$
这也就说明离散系统稳定性的条件是其雅可比矩阵的所有本征值均落在复平面上的单位圆内。（注意：这与连续系统的稳定性的条件不同，直观上，你可以看看 $e^{st}$ 和 $z^{k}$ 的区别）。
- 连续系统的稳定性：通过变换坐标与解耦推导，要求本征值落在复平面的左半平面
- 离散系统的稳定性：通过链式求导法则推导，要求本征值落在复平面的单位圆内

例如，当我们对单摆系统应用时，我们有：
$$
A = \frac{\partial f}{\partial x} = I + h A_{original}
$$
容易知道其本征值不在单位圆内。系统显然不稳定。


## 连续系统的离散化（续）
让我们继续回到线性系统的离散化部分。
一般来说，在实际使用时，我们不会使用 Euler 显格式，而会使用另外一种显格式：Runge-Kutta 格式。直觉上，最简单的迎风 Euler 格式使用 Taylor 展开得到一条直线，而 Runge-Kutta 格式则使得我们得到一个三次曲线。
实际上，显式格式的积分器经常不稳定，因此我们经常使用一些隐式积分器。这种积分器使用隐函数：
$$
f_{d}(x_{n+1},x_{n},u_{n}) = 0
$$
或者说，这种积分器在做这样的工作：
$$
x_{n+1} = x_{n} + hf(x_{n+1})
$$
因此，在每一步中，我们要求解上述方程的根。
这种隐式格式导致（额外的）系统能量耗散，正如显式格式可能导致系统能量的增加。