#StochasticProcess 

设 $(\Omega, \mathcal{F} ,\mathbb{P})$ 是概率空间，一个马氏链是一列具有马尔可夫性质的随机变量 $\{X_{t}\}$。我们假设这些随机变量只在状态空间 $S$ 中取值。马尔可夫性质表述为：
$$
\mathbb{P}(X_{n+1} = i_{n+1}|\{X_{m} = i_{m}\}_{m=0}^{n}) = \mathbb{P}(X_{n+1} = i_{n+1} |X_{n} = i _{n}) 
$$
一个离散时间马氏链有两个关键要素：状态空间和转移概率。不失一般性，我们将状态空间：$S =\{1,2,\cdots,S\}$，转移概率定义为：$p_{kj}^{(n)} = \mathbb{P}(X_{n+1} = j |X_{n}= k )$，如果 $p_{kj}$ 与 $n$ 无关，那么这个马氏链是平稳的。我们会将 $p_{kj}$ 排列成矩阵来方便书写。（显然，这个矩阵的行和为 1）马氏链满足如下基本性质：
>[!note] Chapman-Kolmogorov 方程
> $\mathbb{P}(X_{n}  = j|X_{0} = i) = \sum_{k}P (X_{n}=j|X_{m} = k) P (X_{m} =k|X_{0}=i) \quad  1 \le m \le n-1$

利用这个方程，我们立刻得到：
$$
\mathbb{P}(X_{n} = i_{n}|X_{0} = i_{0}) = \sum_{i_{1},\cdots i_{n-1}} p_{i_{0}i_{1}}p_{i_{1}i_{2}}\cdots p_{i_{n-1}i_{n}} = (P^{n})_{i_{0}i_{n}}
$$

设马氏链在各个状态上初始分布为 $\mu_{0}$，那么立刻写出它的 $n$ 时间步之后的分布是：
$$
\mu_{n} = \mu_{0}P^{n}
$$
我们说分布 $\pi$ 是一个不变分布（稳态分布），如果：
$$
\pi = \pi P
$$
我们现在要研究稳态分布的存在性和唯一性，这与 $P$ 的谱特征密切相关。我们首先证明引理：
>[!note]
> $P$ 的谱半径是 1.

证明很简单：设 $u$ 是 $P$ 的左本征矢量，那么 $\lambda u_{i} = \sum_{j} u_{j} p_{ji}$，或者说：
$$
|\lambda| \sum_{i} |u_{i}| = \sum_{i} |\sum_{j} u_{j}p_{ji}| \le \sum_{ij} |u_{j}| p_{ji} = \sum_{j} |u_{j}|
$$
从而得证。

假如一个矩阵 $P$ 能被初等行、列变换变成下面的样子：
$$
R^{T} P R  = \begin{bmatrix}A_{1} & B  \\  0 & A_{2}\end{bmatrix}
$$
另外，如果对于一组 $k_{1},\cdots , k_{s-1}$ 有 $p_{k_{0}k_{1}} \cdots  p_{k_{s-1} k_{s}}>0, k_{0} = i, k_{s} = j$，那么我们就称从状态 $i$ 可达状态 $j$。如果两个状态 $i,j$ 相互可达，那么我们称 $(i,j)$ 状态对是互通的。直观上，如果矩阵 $P$ 可约，说明有一些状态是无法到达其他状态的，实际上我们有引理：
>[!note] 
>不可约等价于 $S$ 中任意两个状态互通。

在不可约的条件下，不变分布的存在性和唯一性由如下定理保证：
>[!note]
>设 $A$ 是不可约非负矩阵，其谱半径为 $\rho(A)$，那么：
>- $A$ 有非负的左、右本征矢量
>- $\lambda = \rho(A)$ 的重数为 1.

从直观上来看，$R^{T} PR$ 相当于对马氏链中的节点更换序号，也就是说，不可约性等价于在图中看来，没有一个节点的子集是连通的，而且没有边从这个子集中指出。这可能导致不变分布的唯一性被破坏。

不变分布的唯一性不能保证马氏链的遍历性，我们现在研究马氏链满足强遍历性的条件，也就是满足
$$
\mu_{n} = \mu_{0} P^{n} \rightarrow  \pi 
$$
的条件。一个马尔科夫链被称为是本原的，如果存在 $s$ ，对于任意对 $(i,j)$，使得 $(P^{s})_{ij} >0$ 成立。
>[!note] 马氏链满足遍历性的条件
>假设马氏链是本原的，那么对于任意初始分布 $\mu_{0}$，$\mu_{n} = \mu_{0}P^{n}$ 以指数速度趋于 $\pi$。
>

证明：给定两个分布 $\mu_{0}$ 和 $\tilde \mu_{0}$，我们可以定义它们之间的距离：
$$
d(\mu_{0} , \tilde \mu_{0}) = \dfrac{1}{2}  \sum_{i} |\mu_{u,i} - \tilde \mu_{0,i} |
$$
记 $a^{+} = \max (a, 0), a^{-}= \min(a,0)$，那么:
$$
0 = \sum_{i}(\mu_{0,i} - \tilde \mu_{0,i}) = \sum_{i}(\mu_{0,i} - \tilde \mu_{0,i})^{+}- \sum_{I}(\mu_{0,i} - \tilde \mu_{0,i})^{-}
$$
同时也有：
$$
d(\mu_{0},\tilde \mu_{0}) = \dfrac{1}{2} \sum_{i}(\mu_{0,i}- \tilde \mu_{0,i})^{+} + \dfrac{1}{2} \sum_{i}(\mu_{0,i} - \tilde \mu_{0,i})^{-}
 = \sum_{i}(\mu_{0,i} - \tilde \mu_{0,i})^{+}\le 1
$$
现在令 $\mu_{s} = \mu_{0}P^{s}， \tilde mu_{s}  = \tilde \mu_{0} P^{s}$，计算：
$$
\begin{align*}
d(\mu_{s},\tilde \mu_{s}) &= \sum_{i \in S}\left[\sum_{j\in S}(\mu_{0,j}(P^{s})_{ji} - \tilde \mu_{0,j}(P^{s})_{ji})\right]^{+}\\
&= \left(\sum_{j \in S} \mu_{0,j} - \tilde \mu_{0,j}\right)^{+} \sum_{i \in B^{+}} (P^{s})_{ji}\\
&\le   \sum_{j \in S} (\mu_{0,j} - \tilde \mu_{0,j})^{+} \sum_{i\in B^{+}} (P^{s})_{ji} 
\end{align*}
$$
我们这里引入记号 $B^{+}$ 代表下标 $i$ 满足 $\sum_{j\in S} (\mu_{0, j} - \tilde \mu_{0, j}) (P^{s})_{ji}$ 的集合，也就是说由于 $(\cdot)^{+}$ 的存在，$\sum_{i}$ 必然不是对所有的 $i$ 求和的。那么现在设 $(P^{s})_{ij} > \alpha$，那么：
$$
d(\mu_{s} , \tilde \mu_{s}) \le  d(\mu_{0}, \tilde \mu_{0}) (1- \alpha)
$$
容易证明 $\{\mu_{i}\}$ 是一个 Cauchy 列，收敛到极限 $\pi$，并且我们很容易证明这个收敛点是唯一的。

>[!note] 遍历定理
>设 $\{X_{m}\}$ 是不可约有限马尔科夫链（甚至不要求它是满足上述强便利条件的），$f$ 是从 $S$ 到 $\mathbb{R}$ 的有界函数，那么时间平均收敛到系综平均，也就是说：
> $\dfrac{1}{n} \sum_{m=0}^{n-1} f (X_{m}) \rightarrow \langle f \rangle = \sum_{i\in S} f (i) \pi_{i}$



