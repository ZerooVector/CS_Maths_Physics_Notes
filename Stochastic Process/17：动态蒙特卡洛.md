#StochasticProcess 

动态蒙特卡洛算法是模拟一些动力学过程的蒙特卡洛算法，这里我们再以一维伊辛模型举个例子。我们将粒子分为六类：
![[Pasted image 20240806165813.png|400]]

现在，如果某个位置上的自旋被反转，那么反转前、后的能量差只与这个位置上的类别有关。我们将位置 $i$ 上的反转概率记为：$P_{i} = \min(1, \exp(- \beta \Delta H_{i}))$，定义：
$$
Q_{i} = \sum_{j=1}^{i} n_{j} P_{j}
$$
并令 $Q_{0} = 0$，$n_{j}$ 是处于第 $j$ 类的粒子数目。那么一种动态蒙特卡洛方法如下：
- 生成 $R \sim \mathcal{U}[0,Q_{6})$
- 根据 $Q_{K-1} \le R < Q_{k}$，确定下标 $K$
- 在第 $K$ 类中选择一个点反转
这个算法是 rejection-free 的，换言之，这个算法不会拒绝已经选出的点。如果系统平均每 $T_{a}$ 时间尝试翻转一次，那么系统在单位时间内的翻转概率是 $\dfrac{Q_{6}}{T_{a}}$。实际上，这种方法相当于将离散时间马氏链换成了一个连续时间马氏链：
$$
q_{ij}= \begin{cases}
 1_{Q_{ij}} A_{ij} \quad  i \not = j  \\
q_{ii}= - \sum_{j \not = i} q_{ij} \quad  i = j 
\end{cases}
$$

