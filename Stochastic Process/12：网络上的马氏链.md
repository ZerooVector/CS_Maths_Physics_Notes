#StochasticProcess 

我们给定一张图，它有节点集合 $S = \{1,2,\cdots,I\}$ 和邻接矩阵 $W = e_{ij}$。在这个图上，我们可以自然地定义一个马氏链，其转移概率为：
$$
p_{ij} = \dfrac{e_{ij}}{d_{i}} \quad d_{i} = \sum e_{ik}
$$
容易验证其平稳分布是：
$$
\pi_{i} = \dfrac{d_{i}}{\sum_{k \in S} d_{k}}
$$
而且这个分布满足精细平衡条件。我们在图上可以定义矢量 $u$ 和 $v$，维度和图的节点数一样，我们可以定义由平稳分布 $\pi_{i}$ 加权的内积：
$$
(u,v)_{\pi} = \sum_{i} u_{i}v_{i}\pi_{i}
$$
在这个内积的定义下，$\mathbb{P}$ 是自伴的。定义 $\lambda_{k}$ 是 $P$ 的本征值，$\phi_{k}$ 和 $\psi_{k}$ 分别是对应的右、左本征矢，那么有：$(\phi_{j},\phi_{k})_{\pi} = \delta_{jk} ,\psi_{k, i} = \phi_{k, i} \pi_{i}$，以及：$P\phi_{k} = \lambda_{k} \phi_{k}, \psi^{T}_{k} P = \lambda_{k} \psi^{T}_{k}$。显然，$1$ 是 $P$ 的本征值，并且 $P$ 的其他本征值全部分布在区间 $[-1,1]$ 中，我们将本征值从 $\lambda_{0}$ 到 $\lambda_{I-1}$ 按照绝对值从大到小排序，那么 $P^{t}$ 的谱分解为：
$$
(P^{t})_{ij} = \sum_{k=0}^{I-1} \lambda_{k}^{t} \phi_{k,i} \psi_{k,j}
$$

我们接下来研究马氏链的可合并性。给出状态空间的一个两两不交的划分 $C_{i}$，我们定义合并过程：
$$
p_{i_{0}i_{1},\cdots ,i_{m}} = \mathbb{P} \{X_{m} \in C_{im} |X_{m-1}\in C_{i_{m-1} },\cdots , X_{0} \in C_{i_{0}}\}
$$
我们定义可合并性是：对于 $X_{0}$ 的任意初始分布 $\mu_{0}$，以上合并过程是一个马氏链，并且其转移概率矩阵不依赖于 $\mu_0$。

>[!note]
>马氏链可合并的充要条件是：对于任意划分 $l$ 有：$p_{i, C_{l}} = \sum_{j \in C_{l}} p_{ij}$ 是分段常数。

>[!note]
>状态空间被划分为 $K$ 份的马氏链可合并，且合并马氏链的转移矩阵非奇异，当且仅当 $P$ 有 $K$ 个对划分分段常数的本征矢量，且对应的本征值非零。

对于一个随机矩阵 $Q$，其不变分布我欸 $\pi$， 我们可以定义其范数：
$$
||Q||_{\pi}^{2} = \sum_{i,j \in S} \dfrac{\pi_{i}}{\pi_{j}} q_{ij}^{2}
$$
这个范数实际上是 $Q$ 的本征值的平方和。我们很容易从一个粗化后的随机矩阵 $\hat P$ 给出原始的随机矩阵 $\tilde P$：
$$
\tilde p_{ij} = \dfrac{\pi_{j} \hat p_{kl}}{\sum_{k \in C_{l}} \pi_{k}} \quad i \in C_{k} , j \in C_{l}
$$
因此一个重要的问题是计算最佳的粗化矩阵：
$$
\min_{\hat P \cdot 1 = 1 ,\hat P >0} ||\tilde P - P||_{\pi}
$$



