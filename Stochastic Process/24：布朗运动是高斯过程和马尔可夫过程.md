 #StochasticProcess 

显然，根据前面的两个定义，布朗运动是个高斯过程，它的均值和方差是：
$$
\mathbb{E} W_{t} = 0 \quad \mathbb{E}(W_{t} W_{s}) = \min(t,s)
$$
根据之前我们对高斯过程的研究，现在我们对布朗运动进行分解。考虑本征值问题：
$$
\int_{0}^{1} \min(s,t) \phi_{k}(t) dt  = \lambda_{k}\phi_{k}(s)
$$
这可以写成：
$$
\int_{0}^{s} t \phi_{k}(t) dt + \int_{s}^{1} s \phi_{k}(t) dt = \lambda_{k} \phi_{k}(s)
$$
上式两侧对 $s$ 求一阶导数，有：
$$
\lambda_{k} \phi'_{k}(s) = \int_{s}^{1} \phi_{k}(t) dt 
$$
再求导一次，得到的就是简谐振动的方程：
$$
\lambda_{k} \phi_{k}''(s) = - \phi_{k}(s)
$$
那么，布朗运动的分解是：
$$
W_{t} = \sum  \alpha_{k} \dfrac{\sqrt 2}{\left(k - \frac{1}{2}\right)\pi} \sin\left(\left(k - \dfrac{1}{2}\right) \pi  t\right)
$$

当然，这一组正弦函数基底不是唯一一组能够构成布朗运动的基底，我们记：
$$
\psi(t) = \begin{cases}
1  \quad t \in [0,\dfrac{1}{2})  \\
-1 \quad  t \in [\dfrac{1}{2},1)  \\
0 \quad  otherwise
\end{cases}
$$
那么可以构造定义在 $[0,1]$ 上的 Harr 基：
$$
H_{k}^{(n)} (t) = 2^{\frac{n-1}{2}} \psi(2^{n-1} t  - k)  \quad k \in I_{n} = \{0,1,\cdots,2^{n-1}-1\}
$$
对于这组基，我们有：
>[!note]
>设 $\alpha_{k}$ 是独立同分布的标准高斯随机变量，那么下式几乎处处收敛：$W_{t}^{N} = \sum_{n=0}^{N }\sum_{k \in I_{n}} \alpha_{k}^{(n)}\int_{0}^{T}  H_{k}^{(n)}  (s) ds \rightarrow W_{t}$

我们可以先直观的感受一下这个为什么是对的。首先，$W_{t}^{N}$ 的期望必定为 0，此外，计算方差：
$$
\begin{align*}
\mathbb{E} W_{t}^{N}W_{s}^{N} &= \sum_{n=0}^{N} \sum_{k \in I_{n}}  \int_{0}^{t} H_{k}^{(n)} (\tau ) d \tau  \int_{0}^{s} H_{k}^{(n)}(\tau) d \tau \\
&= \sum_{n=0}^{N} \sum_{k \in I_{n}} \int_{0}^{1} H_{k}^{(n)} (\tau) \chi_{[0,t]} (\tau) d \tau  \int_{0}^{1} H_{k}^{(n)}  (\tau) \chi_{[0,s]}(\tau) d \tau  \\
& \rightarrow \int_{0}^{1}\chi_{[0,t]} )(\tau) \chi_{[0,s]}(\tau) d \tau=\min(t,s)
\end{align*}
$$
在最后一步中，由于 Harr 基是正交基，我们使用了帕塞瓦尔等式。

现在我们来做正式的证明。首先证明 $W_{t}$ 收敛到一个连续函数。首先，设 $\xi \sim N(0,1)$，那么：
$$
\mathbb{P}(|\xi | > x) = \sqrt{\dfrac{2}{\pi}} \int_{x}^{\infty} \exp\left( - \dfrac{y^{2}}{2}\right)  dy  \le  \sqrt{\dfrac{2}{\pi}} \int_{x}^{\infty} \dfrac{y}{x} \exp\left( - \dfrac{y^{2}}{2}\right) = \sqrt{\dfrac{2}{\pi}} \dfrac{\exp\left( - \dfrac{x^{2}}{2}\right)}x{ }
$$
令 $a_{n} = \max_{k \in I_{n}} |\alpha_{k}^{(n)}|$，那么，考虑 $\{a_{n} > n\}$ 这一列事件概率之和：
$$
\mathbb{P}(a_{n} > n )  = \mathbb{P}(\bigcup _{k \in I_{n}}|\alpha_{k}^{(n)} > n |)   \le  2^{n-1} \sqrt{\dfrac{2}{\pi} } \dfrac{\exp\left(- \dfrac{n^{2}}{2}\right)}{n}
$$
由于右侧求和有限，那么使用 B-C 引理，对于随机变量  $a_{m}$ 的样本空间 $\tilde \Omega$ 中的每一个元素 $\omega \in \tilde \Omega$，都存在 $N(\omega)$ 使得 $a_{m}(\omega) \le m$ 对于任意 $m \ge N(\omega)$ 。对于这样的 $\omega$，我们直接计算函数项级数的部分和：
$$
|\sum_{m = N(\omega)}^{\infty}\sum_{k \in I_{m}} \alpha_{k}^{(m)}  \int_{0}^{t}  H_{k}^{(m)}  (s) ds|  \le  \sum_{m = N(\omega)}^{\infty} m \sum_{K \in I_{m}} \int_{0}^{t}  H_{k}^{(m)}  (s) ds  \le  \sum_{m=N(\omega)}^{\infty}  m 2^{- \frac{m+1}{2}}  < \infty 
$$
部分和有限，这意味着 $W_{t}^{N}$ 收敛到一个连续函数。由于我们已经计算过其均值和方差，我们可以确定其极限就是布朗运动。


显然，布朗运动不仅是高斯过程，也是马尔可夫过程，我们将其在 $n$ 个时间点的联合概率写为：
$$
p_{n}(w_{1},\cdots ,w_{n}) = \dfrac{1}{Z_{n}} \exp(- I_{n}(w ))
$$
$$
I_{n}(w) = \dfrac{1}{2} \sum_{i=1}^{n} \left(\dfrac{w_{i} - w_{i-1}}{t_{i} - t_{i-1}}\right)^{2} (t_{i} - t_{i-1}) \quad  Z_{n} = (2\pi)^{\frac{n}{2}}[t_{1}(t_{2} - t_{1}) \cdots (t_{n}- t _{n-1})]^{\frac{1}{2}}
$$
那么：
$$
\mathbb{P}(W_{t} \in B |W_{s}= y) = \int_{B} \dfrac{1}{\sqrt{2\pi (t-s)}} \exp\left( - \dfrac{(x-y)^{2}}{2(t-s)} \right)   dx = \int_{B}  p(x,t|y,s)dx
$$
转移概率 $p(x,t|y,s)$ 服从 $p (x, t|y, s) = p(x-y,t-s,0,0)$，而 $p(x,t|0,0)$ 服从扩散微分方程：
$$
\dfrac{\partial p}{\partial t} = \dfrac{1}{2 } \dfrac{\partial ^{2} p}{\partial  x^{2}}
$$
我们可以计算其生成元：
$$
\begin{align*}
\mathcal{A}f(x) &= \lim_{t \rightarrow  0 }\dfrac{1}{t} [\mathbb{E}^{x} f(W_{t}) - f(x)] \\
&= \lim_{t \rightarrow 0}  \dfrac{t}{t}  \int f(y) p(y,t|x,0)  dy - f(x) \\
&= \lim_{t  \rightarrow 0} \dfrac{t}{t} \int \dfrac{\partial p}{\partial t}|_{y,0}f(y) dy   \\
&= \lim_{t \rightarrow 0} \dfrac{t}{2t} \int \dfrac{\partial^{2} p  }{\partial y^{2}}|_{y,0} f(y) dy \\
&= \dfrac{1}{2} \dfrac{\partial ^{2}f}{\partial x^{2}}
\end{align*}
$$
在最后一步中稿，这里的 $p(y,0|x,0)$ 是 $\delta$ 函数，只会将 $f(x)$ 筛选出来。
