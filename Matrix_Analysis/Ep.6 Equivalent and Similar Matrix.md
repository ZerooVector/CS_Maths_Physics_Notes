#MA  

## 等价和相似的定义
### 等价
##### Def
$A, B \in \mathbb F^{m \times n}$，如果存在可逆矩阵 $P \in \mathbb F^{n\times n}, Q \in \mathbb F^{m\times m}$，使得 $AP=QB$，那么称 $A, B$ 是等价的。
注：线性代数中定义的等价是 $TAS = B$, 其中 $T, S$ 均可逆，这意味着矩阵 $A$ 可以通过一系列的初等行变换和初等列变换变成 $B$，则称 $A$ 和 $B$ 等价。在这个定义下，等价就是用来描述初等行（列）变换的。
现在，我们从另一个角度看矩阵的等价：
$$
A[p_1,\cdots,p_n] = [q_1,\cdots,q_m]B
$$
如果将 $A$ 视为一个 $\mathbb F^n \rightarrow \mathbb F^m$ 的线性映射，将 $n$ 个列向量映射到了 $m$ 维空间中；$P$ 的各个列向量可以看作标准列空间中的标准基，也就是入口基；$Q$ 的各个列向量可以看作出口基，那么 $B$ 就是线性映射的表示，$B$ 也有 $n$ 列（因为等待变换的向量有 $n$ 个，有 $m$ 行）
**那么，若 $A$ 和 $B$ 等价，线性映射 $A$ 在入口基 $P$ 和出口基 $Q$ 下的矩阵表示为 $B$。或者说，把 $P$ 的列向量由 $A$ 映射，映射的结果在基 $Q$ 下展开，排列成列向量，就组成了 $B$**
几何上，两个矩阵等价，意味着两个矩阵在两组不同的基底上描述了同一组线性变换。

现在，我们有一个问题：如何恰当地选择入口基和出口基，从而使得线性变换的矩阵表示是尽可能简单？我们已经知道，可以找到矩阵 $T, S$，使得
$$
TAS = \begin{bmatrix}
I_r & O\\
O & O
\end{bmatrix}
$$
现在取 $Q = T^{-1},P=S$，那么存在
$$
AP = Q\begin{bmatrix}
I_r & O\\
O & O
\end{bmatrix}
$$
那么
$$
Ap_1 = q_1,Ap_2=q_2,\cdots,Ap_r = q_r;Ap_{r+1} =\vec 0,Ap_n=\vec 0
$$
也就是说，这个线性映射将 $p_1,\cdots, p_r$ 映射到 $q_1,\cdots,q_r$；将 $p_{r+1},\cdots,p_n$ 映射到 $\vec 0$（注意，我们现在是向量映射到向量，还没有说坐标，跟出口基没有关系!），也就是说 $q_1,\cdots,q_r$ 是矩阵 $A$ 的像，$p_{r+1},p_n$ 是 $A$ 的核。
在标准基 $T_n,I_m$ 下，线性映射将**坐标** $x\mapsto Ax$，但在新的基底 $P, Q$ 下，线性映射将坐标 $x'\mapsto y=Bx'$ ，$x'$ 是原向量在 $P$ 下的坐标，$Bx'$ 是映射后的向量在 $Q$ 下的坐标（因为 $B$ 是线性变换的矩阵表示）
根据 $B$ 的形状， $y_1' = x_1', y_2'=x_2',\cdots, y_r'=x_r', y_{r+1}'=0$ 。
这意味着，在我们选择的入口基和出口基下，这个映射被解耦成 $r$ 的个单入单出的系统。在 $x\mapsto Ax$ 的变换下：
$$
y_1 = a_{11}x_1+a_{12}x_2+\cdots+a_{1n}x_n
$$
$y_1$ 是和 $n$ 个 $x_i$ 搅合在一起，所有的输入都对输出通道 1 有影响，现在，通过选择合适的基底，我们可以使得输出 1 仅仅被输入 1 所影响。

### 相似
##### Def 
$A, B \in \mathbb F^{n\times n}$，如果存在 $n$ 阶可逆矩阵 $P$ 使得：
$$
AP = PB
$$
则称 $A$ 和 $B$ 相似。在线性代数中的定义是 $P^{-1}AP=B$
在几何意义上，若矩阵 $A$ 和 $B$ 相似，则线性变换 $A$ 在入口基 $P$，出口基也为 $P$ 下的矩阵表示为 $B$。我们现在也希望使得 $B$ 的形式更加简单。

##### Def 方阵（线性变换）的不变子空间
$A\in \mathbb F^{n\times n}$, $W\subseteq \mathbb F^n$ 是子空间。如果 $A (W) \subseteq W$，则称 $W$ 是 $A$ 的不变子空间。
显然，$\{0\},\mathbb F^n$ 是 $A$ 的不变子空间，此外，不显然的是，$Ker(A),Im(A)$ 都是 $A$ 的不变子空间。（留做习题答案略，读者自证不难）

##### Theorem 不变子空间与相似对角化两事物的等同性
$$
AP = PB\ ,\ P = [P_1,P_2]\ ,\ B = \begin{bmatrix}
B_{11} & B_{12}\\
B_{21}& B_{22}
\end{bmatrix}
$$
则：
- 若 $B_{21}=0$，等价于 $Im(P_1)$ 是 $A$ 的不变子空间
- 若 $B_{12}=0$，等价于 $Im(P_2)$ 是 $A$ 的不变子空间
==这个是为什么==
##### PF 
$$
AP_1 = P_1B_{11}+P_2B_{21}
$$
如果 $B_{21} = 0$，那么
$$
AP_1 = P_1B_{11}
$$
对于其中一列：
$$
Ap_j =\sum_i b_{ij}p_i
$$
等式右侧就是 $P_1$ 的像空间，也就是说，$Ap_j \in Im(P_1)$
那么现在，从 $Im(P_1)$ 里面随便找一个向量出来，它无非就是各个 $p_j$ 的线性组合，被 $A$ 作用以后仍然会落在 $Im(P_1)$ 里面（式子右边多加几项求和式而已）。从而 $Im(P_1)$ 是 $A$ 的不变子空间。
也就是说，若 $B$ 是对角矩阵，那么 $Im(P)$ 是 $A$ 的不变子空间

首先，利用这个性质，我们考虑将矩阵相似上三角化。
我们给出不变子空间的生成元：$W = span\{v_1, v_2,\cdots,v_t\}$。那么，为了使得 $P$ 中的一部分 ($P_1$) 的像空间是 $A$ 的不变子空间，即 $Im(P_1)=W$，那么，我们应该使用 $W$ 的生成元，即 $v_1,\cdots,v_t$ 作为 $P$ 的前 $t$ 个列向量。我们选择一组基 $\{v_1,\cdots,v_t,u_1,\cdots,u_{n-t}\}$ ，由它们作为列向量拼接成的矩阵 $P=[P_1, P_2]$ 即为所求。这个时候，
$$
A[P_1,P_2] = [P_1,P_2] 
\begin{bmatrix}
X & X\\
O & X
\end{bmatrix}
$$
这是因为 $Im (P_1)$ 已经是 $A$ 的不变子空间，那么表达 $AP_1$ 的时候无需使用 $P_2$ 部分
**这里其实只要记住这一点就行——P 矩阵中如果有一部分是 A 的不变子空间，那么 B 中就会有相应的一部分全是 0 元素**
接下来，我们再进一步，试图将 $A$ 相似对角化。

##### Theorem 相似对角化的条件
根据上面的讨论，矩阵 $A$ 可以写成
$$
A P = P\ \mathrm{diag}(a_1,a_2,\cdots,a_n)
$$
的条件是：$P$ 的每一个列向量都必须是 $A$ 的不变子空间！（相当于将 $P$ 分了 $n$ 块！）
这使得我们进行一个定义：
##### Def : 本征值和本征矢量
$$
Ap = p\lambda
$$
这意味着列向量 $p$ 是 $A$ 的（一维）不变子空间，规定 $p\not = 0$，则 $\lambda$ 为 $A$ 的一个本征值，$p$ 为本征值 $\lambda$ 相应的一个本征矢量。
我们将上面的相似对角化的条件重新表述为：矩阵 $A$ 存在 $n$ 个线性无关的本征矢量。



