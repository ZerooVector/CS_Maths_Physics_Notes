#TraditionalComputerScience 
## 文件管理基础
文件控制块：存放控制文件所需的各种信息的数据结构。包含文件的基本信息、存取控制信息和使用信息

文件的操作：我们可以对文件进行以下操作：
![[Pasted image 20231205211617.png]]
注意：打开文件会涉及到两张表：每个进程打开的文件表和系统打开的文件表。在系统打开文件表中会有一个计数器。

## 文件的结构

### 逻辑结构
- 无结构文件
- 有结构文件
	- 顺序文件：通常是定长的，可以有串结构和顺序结构
	- 索引文件：针对变长记录查找困难的问题，可以建立索引
	- 索引顺序文件：将顺序文件中的记录分为若干组，为这些组建立索引表

### 物理结构
- 连续分配：每个文件记录起始位置和长度。这种方式支持顺序访问和直接访问，但是文件长度不宜动态增加、插入和删除记录时必须移动相邻的记录、产生外部碎片等等
- 链接分配 ：
	- 隐式链接：每个盘块含有指向下一个盘块的指针（只能顺序访问，稳定性成问题），通常采用聚簇的方法
	- 显式链接：FAT 表。这种方法没有碎片，支持随机访问，文件可扩展
- 索引分配：每个文件都有一个索引块，索引块的第 $i$ 个条目指向文件的第 $i$ 块。
注意：混合索引分配是高频考点。对于小文件，可以直接从索引节点读出该文件的所有盘块号；对于大一些的文件，则需要多次间址。


## 文件目录

- 单级目录：只建立一张目录表，每个文件对应一个目录项。这种情况查找速度慢、不允许重名。
- 两级目录：分成主文件目录和用户文件目录两级
- 树形结构
- 无环图结构：方便地实现了文件的共享，需要文件共享计数器。

文件共享的方式：基于索引节点的方式（硬链接）、基于符号链接的方式（软连接）。符号链接其实就是 Windows 里面的快捷方式，它会创建一个新文件，但是这个新文件中只包含被共享文件的路径。


## 文件系统
文件系统的结构是：应用程序->逻辑文件系统（管理文件的元数据，例如目录结构等）->文件组织模块（管理逻辑块和物理块）->基本文件系统（给驱动程序发送通用命令，也管理内存缓冲区）->IO 控制->设备


文件系统在磁盘中的结构是：
![[28250b0d5cbd322fc00f87eb2e75f78.jpg]]
主引导记录位于 0 号扇区，用于引导计算机；超级块包含文件系统所有重要信息，在计算机启动时被载入内存

文件系统在内存中的结构包括安装表（包含了每个已安装的文件系统分区的信息）、目录结构缓存（存储最近访问的目录）、系统打开文件表、进程打开文件表

外存中空闲空间的管理：
- 空闲表法
- 空闲链表法（盘块链、盘区链）
- 位示图法

