#SP 

## 1-5 多项分布
（a）由于所有事件出现的排列顺序可以是不定的，因此 $X_{1}, X_{2},\cdots ,X_{r}$ 的联合分布为：
$$
P(X_{1}= N_{1},X_{2}= N_{2},\cdots ,X_{r}= N_{r} ;p_{1},p_{2},\cdots ,p_{r}) = \frac{(\sum_{i}N_{i})!}{\prod_{i}N_{i}!}\prod_{i}p_{i}^{N_{i}}
$$
这被称为多项分布。
（b）在多项分布中，每个变量实际上都服从二项分布。因此，每个变量的方差都与二项分布的方差相同：
$$
\mathrm{Var}(X_{i}) = \mathrm{Cov}(X_{i},X_{i}) = np_{i}(1-p_{i})
$$
而在 $i \not = j$ 时:
$$
\mathrm{Cov}(X_{i},X_{j}) = \mathrm{E}(X_{i}X_{j}) - \mathrm{E}(X_{i})\mathrm{E}(X_{j}) 
$$
那么我们只需要求解 $\mathrm{E}(X_{i}X_{j})$。为了求解这个期望，使用条件期望的结论，取条件于其中一个变量：
$$
\mathrm{E}(X_{i}X_{j}) = \mathrm{E}[\mathrm{E}(X_{i}X_{j}|X_{j}  = N_{j})]  = \mathrm{E}[X_{j}E(X_{i}|X_{j}= N_{j})]
$$
考虑这一取条件的意义：实际上，相当于我已经固定了 $N_{j}$ 次独立重复实验，规定这些实验中只能出现第 $j$ 个结果。因此，在取完条件后，我们可以认为剩余的所有随机变量 $X_{1}, X_{2},\cdots ,X_{j-1}, X_{j+1},\cdots ,X_{r}$ 服从新的多项分布，且这一多项分布的参数为 $\frac{p_{1}}{1-p_{j}},\frac{p_{2}}{1-p_{j}},\cdots ,\frac{p_{r}}{1-p_{j}}$。那么
$$
E[X_{i}|X_{j} = N_{j}] = \frac{p_{i}}{1-p_{j}}(n-N_{j})
$$
从而继续计算
$$
\begin{align*}
E(X_{i}X_{j}) \\&=  E\left[\frac{p_{i}}{1-p_{j}}(n-N_{j})N_{j}\right] \\ &=   \frac{p_{i}}{1-p_{j}}E[nN_{j}-N_{j}^{2}] \\
&= \frac{p_{i}}{1-p_{j}}(nE[N_{j}]-E[N_{j}^{2}])\\
&= \frac{p_{i}}{1-p_{j}}(nE[N_{j}] - \mathrm{Var}(N_{j})-E[N_{j}]^{2})\\
&= \frac{p_{i}}{1-p_{j}}(n^{2}p_{j}- n(1-p_{j})p_{j} - n^{2}p_{j}^{2})\\
&= (n^{2}-n )p_{i}p_{j}
\end{align*}
$$
因此：
$$
\mathrm{Cov}(X_{i},X_{j}) = (n^{2}-n) p_{i}p_{j} - n^{2}p_{i}p_{j} = -np_{i}p_{j}
$$
（c）最后，我们再来计算未出现的结果数的均值和方差。选取指示变量 $I_{i}$，如果结果 $i$ 不出现，则 $I_{i}=1$，否则 $I_{i}=0$。显然，在 $n$ 次独立重复实验中，结果 $i$ 不出现的概率是 $(1-p_i)^n$ ，也就是说：
$$
P(I_{i}=1) = (1-p_{i})^{n} \Rightarrow E[I_{i}] = (1-p_{i})^{n}
$$
那么，不出现的事件的数目之和的期望：
$$
E = \sum_{i} E[I_{i}] = \sum_{i}(1-p_{i})^{n}
$$
由于变量 $I_{i}$ 服从两点分布，因此其方差为：
$$
\mathrm{Var}[I_{i}] = (1-p_{i})^{n}(1-(1-p_{i})^{n})
$$
现在考虑 $\mathrm{Cov}(I_{i},I_{j})$ ：
$$
\mathrm{Cov}(I_{i},I_{j}) = E[I_{i}I_{j}] - E[I_{i}]E[I_{j}] 
$$
这里要想使得 $I_{i}I_{j}=1$，则必须 $I_{i}=1$ 且 $I_{j}=1$。也就是说，我们要求结果 $i$ 和 $j$ 都没有出现过。那么
$$
E[I_{i}I_{j}] = P(I_{i}I_{j}=1) = (1-p_{i}-p_{j})^{n}
$$
因此：
$$
\mathrm{Cov}(I_{i},I_{j}) = (1-p_{i}-p_{j})^{n} - (1-p_{i})^{n}(1-p)
$$