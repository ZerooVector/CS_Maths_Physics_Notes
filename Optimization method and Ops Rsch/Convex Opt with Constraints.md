#OPTandOR 

## 凸优化问题的标准形式

带有约束条件的凸优化问题，要求目标函数是凸函数，可行域是一个凸集。
![[Pasted image 20230316160025.png]]

一般来说，有约束的凸规划问题往往可以被写成下面的形式：
$$
\begin{align*}
\min f(x)\\
s.t\ g_{i}(x) &\le 0 \quad h_{j}(x)= 0\\
\mathrm{var} \ \ x \in \mathbb{R}^n
\end{align*}
$$
其中，所有的 $g(x)$ 应当是凸函数，而 $h(x)$ 需要是**仿射函数**
##### PF 
证明：我们任取两个点 $x_{1},x_{2}$，分别满足 $g (x_{i})\le 0,h (x_{i})= 0$，我们考察一个新的点，使得
$$
x^{\dagger}= \theta x_{1}+(1-\theta)x_{2}
$$
那么，容易证明：
$$
g(x^{\dagger}) =\theta g(x_{1})+(1-\theta)g(x_{2})
$$
接下来，需要证明：
$$
h(x^{\dagger})= \theta (ax_{1}+b)+(1-\theta )(ax_{2}+b)=0 
$$
因此，两点连线中的点依然位于集合中，因此，该集合是凸集

注意：如果 $h(x)$ 仅仅是凸函数，那么：
$$
h(x)=0 \Rightarrow h(x) \le 0 ,-h(x) \le 0
$$
但是 $-h(x)$ 很可能不是凸函数，因此这样不满足要求。比如，一条二维上的抛物线就不满足要求


## 凸优化问题的实际应用

### 移动通信基站最大传输速率问题
![[Pasted image 20230316161649.png|450]]

其中，$g_{n}$ 是基站到每个用户的信道增益。注意到这个增益是边际递减的，因此我们不能将增益全部加到一个人身上。

### Markowitz 投资模型
设资产分配的向量为 $w$，那么一个好的投资组合应该平衡收益与风险，也就是：
$$
\max w^{T}\mu-\lambda w^{T}\sum  w  \qquad  s.t. \mathcal{1}^{T}w=1 \quad w \ge 0
$$
约束条件：
- 资产分配比例的总和为 1
- 不做空
目标函数：期望-方差的某个倍数

## 凸优化问题的求解——KKT 条件

### KKT 条件的直观表达
要求：若 $f(x)$ 和 $g_{i}(x)$ 都是连续可微的，且 Slater 条件成立，那么 $x^{\star}$ 是全局最优解的充要条件是：
$$
\nabla f(x^{\star})+\sum_{i}\lambda_{i}^{\star} \nabla g_{i}(x^{\star})+\sum_{j} v_{j}^{\star}\nabla h_{j}(x^{\star}) = 0
$$
$$
g_{i}(x^{\star}) \le 0  \quad h_{j} (x^{\star }) = 0
$$
$$
\lambda_{i}^{\star} \ge 0
$$
$$
\lambda_{i}^{\star}g_{i}(x^{\star}) = 0
$$
- 第一个条件：稳定性条件——将一系列的约束条件拿到梯度方程中。直观地理解上，约束条件有可能起作用，也有可能不起作用，因此我们需要引入新的变量来说明约束条件是否起效。
- 第二个条件：原问题可行条件，这是显然的
- 第三个条件：对偶问题可行条件
直观上，我们如果仅仅考虑不等式约束，找到梯度的原函数，我们其实是在优化：
$$
F(x) = f(x)+\lambda g(x)
$$
我们要求 $g (x) \le 0$，那么我们这样做就相当于引入了一个罚函数。根据惩罚的方向，显然应该取 $\lambda_{i}^{\star} > 0$ 。

第四个条件：互补松弛条件
$$
\lambda_{i}^{\star} g_{i}(x^{\star}) = 0
$$
这个条件的直观意义是：每个不等式约束要么生效（$\lambda_{i}^{\star} \not =0,g_{i}(x^{\star})=0$），要么无效（反之）。

### Slater 条件
![[Pasted image 20230316170403.png|400]]
Slater 条件：我们可以在可行域的**内部**至少找到一个点，显然，上面这个问题可行域本身就是一个点，谈不上“内部”

### 例子
![[Pasted image 20230316171142.png|500]]

从作图的方法上：
![[Pasted image 20230316172032.png|300]]

![[Pasted image 20230316172107.png|300]]
绿色：目标函数减小的方向
紫色：约束条件 1 的梯度方向（上升方向）
红色：约束条件 2 的梯度方向（上升方向）

现在，绿色位于紫色和红色之间，意味着我们无法向着绿色的方向再走一步，使得两个不等式约束不被突破，因此，目标函数不能再增大

相反，在其他的位置上，你可以找到一个方向，使得目标函数继续下降
![[Pasted image 20230316172603.png|300]]

### 使用 KKT 求解最优功率分配

对于这个问题，先将 $\lambda_{i}$ 消去，这是因为 $\lambda_{i}$ 仅仅出现在第 $i$ 个等式中
![[Pasted image 20230316173126.png|450]]

![[Pasted image 20230316173709.png|450]]

![[Pasted image 20230316173828.png|450]]

现在，我们只要求出乘子 $\nu^{\star}$，就可以求出最优解。解法是 ：显然，随着 $\nu^\star$ 逐渐增大，等式的左侧单调递减。因此，我们可以直接单向地搜索 $\nu^{\star}$ 的值。由此，我们发明了一种“注水”算法
![[Pasted image 20230323152717.png|400]]

如图，一个水池是凹凸不平的，每块底的高度是 $\frac{N_{0}}{g_{n}}$ 。水池中“水”的高度是 $1/\nu$，那么我们先将它设置为 $\min N_{0}/g_{n}$   
==但是这个算法意义在哪== 

***对于非凸优化问题，KKT 是全局最优解的必要条件，但不是充分条件！*** 

## 有约束凸优化的内点法
提出内点法的初衷是，我们难以解决 KKT 条件中的互补松弛条件
我们考虑使用内点法的方法，引入一个障碍函数：
$$
\min f(x) + \sum_{i} I_{t}(g_{i}(x)) \qquad s.t. h_{j}(x) = 0
$$
其中，障碍函数我们这里必须选用：
$$
I_{t}(u) = - \frac{1}{t}\log(u)
$$
由于 $h_{j}(x) =0$ 是仿射函数，因此我们把这个约束写成:
$$
Ax = b
$$
我们需要讨论这个新的目标函数是不是凸函数：我们要计算 H 矩阵：
![[Pasted image 20230323155007.png]]

第一部分是半正定的，因为 $g_{i}(x)<0$ 的约束条件必然得到满足，而且 $g_{i}(x)$ 是凸函数。后面一部分容易通过 $x\nabla g (x \nabla g)^T$ 这样的方式来证明

对于新的问题中，KKT 条件中不存在互补松弛条件。你可以对 KKT 条件导出的方程组进行求解，或者将线性方程组消去，使用梯度下降法或牛顿法求解无约束凸优化问题

