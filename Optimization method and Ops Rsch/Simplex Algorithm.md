#OPTandOR 

## 基本思想

在只有两个变量时，我们可以使用图解法。我们可以考虑最优解的存在性和唯一性
![[Simplex Algorithm 2023-03-09 15.19.36.excalidraw|500]]

对于多变量的线性规划，我们必须使用其他的算法。单纯形法的思想是：线性规划总是在可行域的顶点处取得最优解！
那么，如何找到这些顶点呢？设标准的线性规划形式有 $m$ 个独立的等式和 $n$ 个变量，那么我们将其中 $n-m$ 个变量置 0，就**有可能**得到顶点的位置，当然，也可能得到非可行解（因为组合的数目远比顶点的数目多）。这些顶点对应的坐标叫做“基可行解”(这个原理是松弛变量的引入，其中一些松弛变量取 0 的时候，基可行解就会走到边界上)
![[Pasted image 20230309154323.png]]
接下来，需要决定对基可行解搜索的顺序。从二维的情况下容易看出，不断向着目标函数更低的方向的相邻顶点搜索，就可以达到最优的顶点。其中，两个恰好相差一个变量的基可行解通常对应着相邻的顶点。

## 实现过程
### STEP 1 : 构造一个基可行解
![[Pasted image 20230309155722.png|400]]
选择一组非零变量，将它们改写成标准形式：**一个方程里面只能存在一个非零变量，非零变量的系数必须是 1**  ，这种操作叫做“旋转”。
之后，我们验证这是不是一个可行解，如果不是，就要重新选取一个。

### STEP 2 : 计算目标函数值
为了方便后续操作，我们将目标函数使用零变量和一个常数写出，这样就能算得目标函数的取值。例如，上面的目标函数被改写为：
$$
5x_1+3x_4-2x_5+21
$$
### STEP 3：选择新的非零变量和零变量
选择新的非零变量，使得目标函数往下走，显然应该选择 $x_5$ 。
选择新的零变量，那么现在要在 $x_2$ 和 $x_3$ 中选择，显然，$x_3$ 被选择为零变量时，得到的点是可行解，而选择 $x_2$ 时，是一个可行解。因此，只能选择 $x_3$ 。

***反复迭代以上过程，直到最优解不能再继续下降（不能选择新的非零变量）为止*** 

因此，单纯形法的一般步骤可以被总结如下：
- 将线性规划化成标准形式
- 找到初始的基可行解
	- 围绕当前的非零变量旋转，改写目标函数，求解目标函数的值
	- 选择目标函数中系数为负的零变量，变成非零变量
	- 选择一个合理的非零变量，变成零变量
- 算法结束

## 细节问题
### 如何选择新的非零变量？
考虑一个改写后的目标函数
$$
5x_{1}-11x_{4}-2x_{5}+21
$$
- 最大系数绝对值：由于 $11>5$，直接将 $x_4$ 选为新的非零变量
- 最小化目标函数：在新的非零变量取值上限的时候，谁能使得目标函数下降最大？
- ![[Pasted image 20230309162726.png]]
- 随机规则
- 最陡峭边原则：使得 $c^{T}\frac{x_{new}-x_{old}}{||x_{new}-x_{old}||}$ 尽可能的小，也就是使得目标函数的变化尽可能大，但是前后两个基可行解的距离尽可能地小
- 布兰德规则：按照序号选择零变量 —— 为什么有效？
这种做法可以确保单纯形法一定能收敛，避免某一组解循环出现。（为什么循环？）
![[Pasted image 20230309163738.png]]
在布兰德规则下，这种循环选择某一顶点的行为就不会出现！

### 如何选择新的零变量？
显然，需要确保新的解是可行解。这有可能不通过穷举来求解吗？
这是可以的。根据之前的例子，首先在已经选好非零变量 $x_{5}$ 的前提下，写出备选的零变量满足的等式。显然，为了使得目标函数更小，必须使得 $x_{5}$ 尽可能大。那么，为了使得 $x_{2},x_{3}$ 都大于 0，$x_{5}$ 只能取到 3，此时 $x_{3}=0$，如果 $x_5$ 继续增大，那么将跑出可行域。因此，我们选择随着非零变量的增大，最先到达可行域边界的变量，即 $x_{3}$ 作为零变量，并取 $x_{5}=3$。
![[Pasted image 20230309164815.png]]

有的时候，最优解不存在，在这样的情况下，选择新的零变量时，你会发现已经选好的非零变量可以取任意值，备选变量都无法达到 0.
![[Pasted image 20230309164915.png]]

### 单纯形法的复杂度怎样？
平均复杂度不高，但是最差的则是指数级别。
![[Pasted image 20230309165747.png]]

