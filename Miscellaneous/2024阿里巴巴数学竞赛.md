## A：消失的塔
首先我们对上界给出证明：对于 $E,F$ 中的每座塔，都需要 $A,B,C,D$ 中的一座塔来挡住，因此方案不超过 $A_{4}^{2} = 12$ 种。绘图可以注意到，如果在射线 $EA,FB$ 的交点处放人是合法的，则在射线 $EB,FA$ 交点处放人必然是不合法的。因此我们的上界其实是 $C_{4}^{2}=6$ 种。接下来可以给出一种旅游团为 $6$ 人的构造。


## B：飞机大战
本题可以猜测一下。在（A）问中，假设先不考虑积分因为时间扣完的情况。假定需要打下一架飞机：
$$
\mathrm{E}(X) \approx  0.15 + 0.85 \times 2.5 = 2.275
$$
假设需要打下两架飞机：
$$
\mathrm{E}(X) \approx  0.15 \times  1 + 0.85 \times (1-0.85 ^{2})\times 1.5 + 0.85^{3}\times 3 \approx  2.35
$$
因此可能打下两架飞机好一些。
模拟结果：
![[Pasted image 20240415022648.png]]
在（B）问中，若打下一架飞机：
$$
\mathrm{E}(X) \approx 0.85 \times 2.5 = 2.125
$$
若打下两架飞机：
$$
\mathrm{E}(X) \approx 0.85^{3} \times 3 \approx 1.8423
$$
因此打下一架飞机好一些。
模拟结果：
![[Pasted image 20240415022802.png]]

## C：稠密格点
（1）在这一小问中，我们直接计算 $A^{n}$，从而得到 $\mathbb{Z}^{2}$ 中每个点被变换后的位置。由于 $\mathrm{tr}(A) = 0$，故 $A$ 的两个本征值 $\lambda_{1} = \sqrt{- \det (A)},\lambda_{2}= - \sqrt{-\det(A)}$ 。 
我们记：
$$
A=  \begin{bmatrix}a & b  \\  c & -a\end{bmatrix}
$$
我们将 $A$ 的两个本征矢量记作 $\vec v_{1}= [x_{1}, y_{1}] = \left[\dfrac{a - b - \lambda_{1}}{a + c - \lambda_{1}}, 1\right], v_{2}= [x_{2}, y_{2}] = \left[\dfrac{a - b - \lambda_{2}}{a + c - \lambda_{2}}, 1\right]$，那么 $A$ 可以被分解为 $A = PDP^{-1}$，其中 $P = \begin{bmatrix}x_{1}& x_{2}  \\  y_{1} & y_{2}\end{bmatrix}$，而 $P^{-1} = \dfrac{1}{x_{1}y_{2} - x_{2}y_{1}}\begin{bmatrix}y_{2} & -x_{2}  \\  -y_{1} & x_{1}\end{bmatrix}$。
因此，我们计算 $A^{n}$（这里如果 $A$ 有复的本征值，那么我们实际上是先将 $A$ 复化为 $A_{c}$，再计算 $A_{c}^{n}$，但是由于 $A$ 的各个元素是实数，那么 $A_{c}^{n}$ 的各个元素也是实数，因此我们可以退回到实数域上）：
$$
A^{n} = P^{-1}D^{n}P = \dfrac{1}{x_{1}y_{2} - x_{2}y_{1}} \begin{bmatrix}y_{2}x_{1} \lambda_{1}^{n} - x_{2}y_{1}\lambda_{2}^{n} & y_{2}x_{2}\lambda_{1}^{n} - x_{2}y_{2}\lambda_{2}^{n}  \\ - y _{1}x_{1}\lambda_{1}^{n} + x_{1}y_{1}\lambda_{2}^{n} & -y_{1}x_{2}\lambda_{1}^{n} + x_{1}y_{2}\lambda_{2}^{n}\end{bmatrix}
$$
因此
$$
A^{n} = \begin{bmatrix} c_{1} (- \det(A))^{n/2} -c_{2}(-1)^{n} (- \det(A))^{n/2}& c_{3} (- \det(A))^{n/2} -c_{4}(-1)^{n} (- \det(A))^{n/2}\\c_{5} (- \det(A))^{n/2} -c_{6}(-1)^{n} (- \det(A))^{n/2}&c_{7} (- \det(A))^{n/2} -c_{8}(-1)^{n} (- \det(A))^{n/2}\end{bmatrix}
$$
考虑 $\mathbb{Z}^{2}$ 中的点 $(i,j)$，它被变换后的点可以写为：
$$
\vec P_{ij} =\begin{bmatrix}i\cdot (c_{1}+c_{3})(- \det(A))^{n/2}-j\cdot(c_{2}+c_{4})(-1)^{n}(- \det(A))^{n/2} \\i\cdot (c_{5}+c_{7})(- \det(A))^{n/2}-j\cdot(c_{6}+c_{8})(-1)^{n}(- \det(A))^{n/2}  \end{bmatrix}
$$
因此，给定 $n$，注意到 $\vec P_{ij}$ 这些点组成了一些全等的平行四边形，其中一个平行四边形的四个顶点是 $\vec P_{00},\vec P_{01},\vec P_{10},\vec P_{11}$ 。因此，$||v-w||$ 的上界可取为平行四边形两条对角线长度的最大值。
![[89dec2123b255fbb7933768d369fdd2.jpg|400]]
由于
$$
||\vec P_{00} - \vec P_{11}|| \le \sqrt{(c_{1}+c_{2}+c_{3}+c_{4})^{2} + (c_{5}+c_{6}+c_{7}+c_{8})^{2}} |\det(A)|^{n/2}
$$
$$
||\vec P_{10} - \vec P_{01}|| \le \sqrt{(c_{1}+c_{2}+c_{3}+c_{4})^{2} + (c_{5}+c_{6}+c_{7}+c_{8})^{2}} |\det(A)|^{n/2}
$$
其中 $c_{1}, c_{2},\cdots ,c_{8}$ 是运算中产生的常数。
我们就证明了：$\forall \ v  \in \mathbb{R}^{2}$，$\exists \ w \in A^{n} \mathbb{Z}^{2}$ 使得：
$$
||v - w|| \le C |\det (A)|^{n/2}
$$
因此，我们证明了 $A^{n} \mathbb{Z}^{2}$ 是 $C|\det(A)|^{n/2}$ 稠密的。


（2）在这一小问中，我们利用闵可夫斯基凸体定理先找到像空间中变换后的两个非零格点。如下图，我们在使用线性变换 $A$ 变换 $n$ 次的空间中取面积为 $4|\det(A)|^{n}$ 的以原点为中心（中心对称）的闭长方形 $ABCD$，其宽 $AB = \eta <2$（$\eta$ 是我们自行选取的常数），长 $BC = \dfrac{4|\det(A)|^{n}}{\eta}$ 。
![[4d617bb48dc31c90168f39a53ab6c2a.jpg|400]]
由于 $A\in M_{2}(\mathbb{Z})$ 且 $\det (A) \not  = 0$，必然有一非零点 $\vec r_{1} \in A^{n}\mathbb{Z}^{2}$ 且 $\vec r_{1} \in ABCD$，它位于被 $ABCD$ 覆盖的某个整数点上，这是因为 $ABCD$ 的原像是以原点为中心且面积为 $4$ 的闭平行四边形，它包含 $\mathbb{Z}^{2}$ 中的非零向量。不失一般性，我们令 $[\cdot]$ 代表向下取整，取 $\vec r_{1} = \left(\dfrac{4|\det (A)|^{n}}{\eta}, 0\right)$。

利用同样的方法，我们选取如下图所示的平行四边形 $A'B'C'D'$，可以在 $y$ 轴上找到一个非零的 $\vec r_{2} \in A^{n} \mathbb{Z}^{2}$，类似地，我们可取 $\vec r_{2} = \left(0, \dfrac{4 |\det(A)|^{n}}{\eta}\right)$ 。
![[aa244d9c100030f54d2d46ea12540bc.jpg|400]]

我们已经知道 $\vec r_{1}, \vec r_{2}$ 的原像都是 $\mathbb{Z}^{2}$ 中的点，我们使用 $A^{-n}$ 表示 $A$ 的逆映射 $A^{-1}$ 作用 $n$ 次，那么我们有 $A^{-n} \vec r_{1} = (m_{1}, n_{1}), \ m_{1}, n_{1} \in  \mathbb{Z}$ ，同理 $A^{-n} \vec r_{2} = (m_{2}, n_{2}), \ m_{2}, n_{2} \in  \mathbb{Z}$。现在，我们在像空间中找点 $\vec P_{ij} = i \vec r_{1} + j \vec r_{2}$ ，那么我们有 
$$A^{-n}\vec P_{ij} =  (im_{1}+j m_{2},in_{1}+jn_{2})$$
由于 $im_{1} + jm_{2} \in \mathbb{Z}, in_{1} + jn_{2} \in \mathbb{Z}$，因此 $A^{-n}\vec P_{ij} \in \mathbb{Z}^{2}$，这意味着 $\vec P_{ij} \in  \mathbb{Z}^{2}$。

因此，我们在像空间内找到了一系列点 $\vec P_{ij} \in A^{n} \mathbb{Z}^{2}$ 注意到这些点组成了一系列的全等的正方形，其中一个正方形的四个顶点是 $\vec P_{00},\vec P_{01},\vec P_{10},\vec P_{11}$，因此，$||v - w||$ 的上界可以选为正方形对角线的长度，也就是说我们证明了：$\forall \ v  \in \mathbb{R}^{2}$，$\exists \ w \in A^{n} \mathbb{Z}^{2}$ 使得：
$$
||v - w|| \le \dfrac{4 \sqrt 2|\det(A)|^{n}}{\eta}
$$
因此，我们证明了 $A^{n} \mathbb{Z}^{2}$ 是 $C|\det(A)|^{n}$ 稠密的。
![[ede8399a79a3805c12c7da70e7a0b5e.jpg|400]]

## D：“正常“高代题
（1）可以写出该线性变换的矩阵表示是
$$
A = \begin{bmatrix}0 & d & 0 &  0 & 0  & \cdots  \\ \frac{1}{2}& 0 & 2d-1 & 0 & 0 &\cdots  \\ 0 & \frac{1}{2} & 0 & 3d-3 & 0 & \cdots  \\ 0 & 0 & \frac{1}{2}& 0 & 4d-6 &\cdots  \\ 0 & 0 & 0 & \frac{1}{2}& 0 & \cdots \\\cdots & \cdots & \cdots & \cdots & \cdots & \cdots   \end{bmatrix}
$$
首先证明 $0$ 是该线性变化的本征值。计算 $\det(A)$，我们用 $A_{i}$ 表示 $A$ 的前 $i$ 行和前 $i$ 列组成的 $i\times i$ 的矩阵的行列式的值，那么：
$$
A_{1} = 0 ,A_{2} = \dfrac{1}{2}d
$$
这是一个三对角矩阵，因此我们可以递推地计算其行列式：
$$
A_{3} =0 \cdot A_{2} -  \dfrac{1}{2}(2d-1) \cdot A_{1} = 0 
$$
同理：
$$
A_{4}= 0 \cdot A_{3} - \dfrac{1}{2}(3d-3) A_{2} = -\dfrac{1}{2}(3d-3)A_{2},A_{5} = 0 \cdot A_{4} - \dfrac{1}{2}(4d-6)A_{3} = 0 
$$
因此可以推出 $A_{2k} \not  = 0, A_{2k+1} = 0$，因此 $0$ 是 $A$ 的本征值。

其次计算其他本征值。考虑计算 $A - \lambda I$ 的行列式，使用 $A(\lambda)_{i}$ 表示 $A - \lambda I$ 的前 $i$ 行和前 $i$ 列组成的 $i\times i$ 的矩阵的行列式的值，则仍有递推式：
$$
A(\lambda)_{i} = \lambda A(\lambda)_{i-1} - \dfrac{1}{2}\dfrac{(i-1)(2d+2-i)}{2}  A(\lambda)_{i-2}
$$
最终得到：
$$
A(\lambda)_{2d+1} = (\lambda+d)(\lambda+d-1)\cdots \lambda \cdots (\lambda-d+1 )(\lambda-d)
$$
因此 $f$ 的全部本征值为 $-d,-d+1,\cdots ,d-1,d$。
（2）$W$ 可以由 $v_{1}, v_{2},\cdots,v_{2d+1}$ 作为基底张成，它的维数为 $2d+1$，因此 $W \cap U_{0}$ 的维数是 $d+1$。
（3）由（2）可知，$W \cap U_{j}$ 的维数为 $d - 2j+1$。



##  E：三倍快乐
不会！你在考什么？

## F：抛硬币，集五福
（1）该抛硬币的过程可以使用马尔可夫过程建模。设 $P_{n}= P(X_{n}\text{为偶数})$，我们只需研究 $P_{n}$ 与 $P_{n-1}$ 的关系。分析可知，第 $n$ 次抛掷硬币后，正面出现的次数为偶数，当且仅当：
- 第 $n-1$ 次抛掷硬币后，正面出现的次数为奇数，在第 $n$ 次扔出了正面
- 第 $n-1$ 次抛掷硬币后，正面出现的次数为偶数，在第 $n$ 次扔出了反面
从而可以得到关于 $P_{n}$ 的递推方程为：
$$
P_{n+1} = \dfrac{2}{3} P_{n} + \dfrac{1}{3} (1-P_{n}) = \dfrac{1}{3}P_{n} + \dfrac{1}{3} 
$$
边界条件为：$P_{1} = \dfrac{2}{3}$。对上式进行变形可以得到：
$$
P_{n+1} - \dfrac{1}{2} = \dfrac{1}{3} (P_{n} - \dfrac{1}{2})
$$
从而 $P_{n} - \dfrac{1}{2}$ 是等比数列。计算可得：
$$
P_{n}=  \left(\dfrac{1}{6}\right)^{n} + \dfrac{1}{2} 
$$
因此，题目所求极限为：
$$
\lim_{n \rightarrow \infty } P(X_{n} \text{为偶数}) = \dfrac{1}{2}
$$

（2）该集五福的过程也可以使用马尔可夫过程建模，但是如果我们使用马尔科夫链的计算方法，需要定义 $2^{5} = 32$ 个状态，这过于繁杂。因此，我们引入一次集五福的生成函数 ：
$$
G(t_{1},t_{2},t_{3},t_{4},t_{5},1) = p_{1}t_{1} + p_{2}t_{2} + p_{3}t_{3}+ p_{4}t_{4} + p_{5}t_{5}
$$
由于每次集五福的活动都是互相独立的，因此，$2n$ 次集五福的生成函数为
$$
G(t_{1},t_{2},t_{3},t_{4},t_{5},2n) = G^{2n}(t_{1},t_{2},t_{3},t_{4},t_{5},1)
$$
$G(t,2n)$ 中的每一项都是形如 $c_{i}t_{1}^{n_{1}}t_{2}^{n_{2}}t_{3}^{n_{3}}t_{4}^{n_{4}}t_{5}^{n_{5}}$ 的多项式，其中 $n_{1}+n_{2}+n_{3}+n_{4}+ n_{5} = 2n$，它的系数 $c_{i}$ 的含义是抽到第 $1$ 种福卡 $n_{1}$ 张，抽到第二种福卡 $n_{2}$ 张……的概率。因此，我们只需选出 $n_{1},n_{2},n_{3},n_{4},n_{5}$ 都为偶数的项，并将前面的系数求和。这可以通过如下求和式计算：
$$
\begin{align*}
P(X_{2n}^{i}\text{全为偶数})  \\
&=  \dfrac{1}{32}\left(\sum_{t_{1} = +1,-1}\sum_{t_{2} = +1,-1}\sum_{t_{3} = +1,-1}\sum_{t_{4} = +1,-1}\sum_{t_{5} = +1,-1}  G(t,2n ) \right)\\
&=  \dfrac{1}{32} ((p_{1}+p_{2}+p_{3}+p_{4}+p_{5})^{2n} +(-p_{1}+p_{2}+p_{3}+p_{4}+p_{5})^{2n}  \cdots  \\ & + (-p_{1}-p_{2}-p_{3}-p_{4}-p_{5})^{2n})\\
\end{align*}
$$
在 $n \rightarrow \infty$ 时，只有 $(p_{1}+p_{2}+p_{3}+p_{4}+p_{5})^{2n}$ 和 $(-p_{1}-p_{2}-p_{3}-p_{4}-p_{5})^{2n}$ 两项是有意义的。因此，题目所求的极限为：
$$
\lim_{n \rightarrow \infty } P(X_{2n}^{i}\text{全为偶数})  = \dfrac{1}{32}(1+1) = \dfrac{1}{16}
$$
因此这个概率是 $\dfrac{1}{16}$，与每种福卡出现的概率无关。这可以使用程序模拟得到验证，我们做出的图像（集五福次数 $2n$ VS 题目所求概率 $P$）如下：
![[Pasted image 20240414201207.png]]

## G：八音盒相遇论
我们先证明一些关于 $f$ 和其反函数 $f^{-1}$ 的简单引理。
引理 1：在 $(0,1)$ 上 $f(x)>x$ 。
证明：取 $g (x) = f(x)-x$，那么 $g(0)=0,g(1)=0$，由罗尔中值定理，存在 $x_{0}\in(0,1)$，使得 $g' (x_{0}) = 0$。由于 $g''(x)<0$，因此 $g'(x)>0$ 在 $(0,x_{0})$ 上成立，而 $g'(x)<0$ 在 $(x_{0},1)$ 上成立。从而 $g (x)$ 在 $(0,x_{0})$ 上单调递增，在 $(x_{0},1)$ 上单调递减，因此 $g(x)>x$ 在 $(0,1)$ 上成立，也就是 $f(x)>x$ 成立。

引理 2：在 $(0,1)$ 上 $f^{-1}(x)<x$。
证明：利用反函数的导数性质。由于 $(f^{-1})' (x) = \dfrac{1}{f'(x)}$，而 $f'(x)$ 在 $(0,1)$ 递减，因此 $(f^{-1})'(x)$ 在 $(0,1)$ 递增且 $(f^{-1})'(x)>0$ 成立。同理构造 $h (x) = f^{-1}(x) -x$ ，那么 $h(0)=0,h(1)=0$，仍然由罗尔中值定理可得存在 $x_{0} \in (0,1)$，使得 $h'(x_{0})=0$，同理可得 $h(x)$ 在 $(0,x_{0})$ 上单调递减，而在 $(x_{0},1)$ 上单调递增。因此 $f^{-1}(x)<x$ 成立。


（1）不失一般性地，我们考察题目中描述的小红追逐小绿的过程。在这个过程中，我们要证明小红和小绿之间的距离不断缩短，直到它们可以相遇。因此，我们假设如题目图中一样，小红和小绿顺时针运行。
由于小红和小绿的运动速度一致，因此它们的距离只有在其中一人停下等待时才发生变化，所以我们只研究二者之间的相对距离。假设初始时，小红落后小绿的距离为 $\Delta_{0}$，首先，小绿停下等待，小绿等待完成后的瞬间，小红落后小绿的距离为 $\Delta_{1}$；其次，小红又停下等待，小红等待完成的瞬间，小红落后小绿的距离为 $\Delta_{2}$，我们可以给出 $\Delta$ 的一个数列 $\Delta_{0},\Delta_{1},\Delta_{2},\cdots$，下面我们对这个数列展开研究。

在小绿第 $k$ 次到达树下时，小红落后小绿 $\Delta_{2k}$，因此小红的位置为 $1 - \Delta_{2k}$，小绿的等待时间为 $K(1 - \Delta_{2k})$，此时小红继续行走，因此二者间距离缩短，我们得到：
$$
\Delta_{2k+1 } = \Delta_{2k} - K(1 - \Delta _{2k})
$$
此后，小红等待开始时，小绿的坐标是 $\Delta_{2k+1}$，因此，在小红等待完成后，二者的距离增长，我们得到：
$$
\Delta_{2k+2} = \Delta_{2k+1}   + K (\Delta_{2k+1})
$$
具体代入题目所给的 $K(\phi)$ 的形式计算，我们可以得到：
$$
\Delta_{2k+1} = \Delta_{2k} - f^{-1}(f(1-\Delta_{2k}) + \epsilon)  + (1 - \Delta_{2k}) = 1 - f^{-1}(f(1-\Delta_{2k}) + \epsilon)
$$
$$
\Delta_{2k+2} = \Delta_{2k+1} + f^{-1}(f(\Delta _{2k+1}) + \epsilon) - \Delta_{2k+1} = f^{-1}(f(\Delta _{2k+1}) + \epsilon)
$$
接下来我们开始证明。我们的证明主要分为两部分：
（a）存在唯一 $x^{\star} \in (\epsilon,1)$， 如果 $0 <\Delta_{2k} < x^{\star}$，那么必然有 $\Delta_{2k+1}<0$，也就是假如两者间的距离已经足够小，那么小绿下一次等待时，小红将追上小绿。
证明：我们考虑 $\Delta_{2k} = \epsilon$ 。此时由引理 1，$f (1 - \Delta_{2k}) > 1 - \epsilon$，因此 $f^{-1}(f (1-\Delta_{2k}) + \epsilon)> 1$ ，因此 $\Delta_{2k+1} < 0$。
而若 $\Delta_{2k} = 1$，显然 $\Delta_{2k+1} > 0$ 。将 $\Delta_{2k+1}$ 对 $\Delta_{2k}$ 求导得到：
$$
\dfrac{\mathrm{d}\Delta_{2k+1}}{\mathrm{d}\Delta_{2k}} = \dfrac{1}{\dfrac{\mathrm{d}f}{\mathrm{d}x}|_{x = x_{1}}} \dfrac{\mathrm{d}f}{\mathrm{d}x} |_{x = x_{2}}
$$
其中 $x_{1} = f (1 - \Delta_{2k}) + \epsilon$，$x_{2} = 1 - \Delta_{2k}$，显然 $\dfrac{\mathrm{d}\Delta_{2k+1}}{\mathrm{d}\Delta_{2k}} > 0$，因此 $\Delta_{2k+1}(\Delta_{2k})$ 在 $(\epsilon,1)$ 上有唯一零点 $x^{\star}$，若 $0<\Delta_{2k} < x^{\star}$，则 $\Delta_{2k+1} < 0$。

（b）除了唯一的例外（特定的初始位置），无论小红初始时落后小绿多少，小红相对落后小绿的距离总能在有限圈（$2k$ 有限）内缩小到 $x^{\star}$ 以内，也就是 $\exists k_{0},\Delta_{2k_{0}} \le x^{\star}$。
证明：为了证明这一点，我们考察小红小绿旋转一圈（也就是小绿等待一次，小红又等待一次）带来的“总效果”。根据上面求出的表达式可以得到 $\Delta_{2k}$ 与 $\Delta_{2k+2}$ 的关系为：
$$
\Delta_{2k+2} = f^{-1}(f(1 - f^{-1}(f(1 - \Delta_{2k}) + \epsilon)) + \epsilon)
$$
因此，小红小绿每转过一圈，它们的相对距离的减少量是：
$$
l = \Delta_{2k} - \Delta_{2k+2} = \Delta_{2k} - f^{-1}(f(1 - f^{-1}(f(1 - \Delta_{2k}) + \epsilon)) + \epsilon)
$$
上式对 $\Delta_{2k}$ 求导数，利用链式法则得到：
$$
\dfrac{\mathrm{d}l}{\mathrm{d} \Delta_{2k}} = 1 - \dfrac{1}{\dfrac{\mathrm{d}f}{\mathrm{d}x}|_{x = x_{1}}} \cdot \dfrac{\mathrm{d}f}{\mathrm{d}x}|_{x = x_{2}} \cdot \dfrac{1}{\dfrac{\mathrm{d}f}{\mathrm{d}x}|_{x = x_{3}}} \cdot \dfrac{\mathrm{d}f}{\mathrm{d}x}|_{x = x_{4}}
$$
上式已经利用了原函数的导数与其反函数的导数之间的关系。其中，四个求导的位置是：
$$
x_{4}= 1 - \Delta_{2k},x_{3} = f(x_{4}) + \epsilon,x_{2} = 1-f^{-1}(x_{3}),x_{1}= f(x_{2}) + \epsilon
$$
在 $\Delta_{2k}>x^{\star}$ 的条件下（由于 $x_{2}= \Delta_{2k+1}$，这意味着 $x_{2}>0$），我们比较上面数值的大小，由引理 1有：$x_{3}>x_{4}$，从而 $\dfrac{\mathrm{d}f}{\mathrm{d}x}|_{x = x_{3}} < \dfrac{\mathrm{d}f}{\mathrm{d}x}|_{x = x_{4}}$ ，从而 $\dfrac{1}{\dfrac{\mathrm{d}f}{\mathrm{d}x}|_{x = x_{3}}} \cdot \dfrac{\mathrm{d}f}{\mathrm{d}x}|_{x = x_{4}}> 1$；类似地，我们有 $x_{1}>x_{2}$，从而有 $\dfrac{1}{\dfrac{\mathrm{d}f}{\mathrm{d}x}|_{x = x_{1}}} \cdot \dfrac{\mathrm{d}f}{\mathrm{d}x}|_{x = x_{2}}> 1$
。因此，导数的符号是 $\dfrac{\mathrm{d}l}{\mathrm{d}\Delta_{2k}}<0$，由于 $l$ 是转过一圈后距离差的减少量，这意味着小红小绿二者距离越远，则每转过一圈后二者距离差的减小量越小，否则反之。

再看两个端点：
$$
l(x^{\star}) = x^{\star} - f^{-1}(\epsilon)
$$
由引理 2，$f^{-1}(\epsilon) < \epsilon$，而在前面我们证明过 $x^{\star}> \epsilon$，因此 $l (x^{\star})> 0$。
$$
l(1) = 1 - f^{-1}(f(1 - f^{-1}(\epsilon)) + \epsilon)
$$
由引理 2可知 $f^{-1}(\epsilon) < \epsilon$，$1 - f^{-1}(\epsilon) > 1 - \epsilon$，从而 $f (1 - f^{-1}(\epsilon))  > 1 - \epsilon$，从而 $f (1 - f^{-1}(\epsilon)) + \epsilon > 1$，从而 $l (1) = 1 - f^{-1}(f (1 - f^{-1}(\epsilon)) + \epsilon) < 0$。

综合上述对于端点（附近）函数值和单调性的分析，我们得到 $l(x^{\star})>0,l(1)<0$，且 $l(x)$ 在 $x \in(x^\star ,1)$ 单调递减，因此在 $x \in (x^{\star},1)$ 间 $l(x)$ 有零点 $l (x^{\dagger}) = 0$。

这里，$x^{\dagger}$ 就是题目中提到的特定初始距离。在小红和小绿的初始间隔 $\Delta_{0} = x^{\dagger}$ 时，无论转多少圈，二者间的距离不变。若 $\Delta_{0}< x^{\dagger}$，则 $l (\Delta_{0}) > 0$，由于 $\Delta_{2} = \Delta_{0} - l(\Delta_{0})$，那么 $\Delta_{2} < \Delta_{0}$，我们记 $l (\Delta_{0}) = c_{1}$，考虑到 $l(x)$ 的单调递减性质，$l (\Delta_{2}) > l(\Delta_{0})$，从而 $\Delta_{0} - \Delta_{4} = \Delta_{0} - l (\Delta_{0}) - l (\Delta_{2}) > 2c_{1}$，继续递推可得到：
$$
\Delta_{0} - \Delta_{2k}  = l(\Delta_{0}) + l(\Delta_{2}) +\cdots + l(\Delta_{2k-2})  > k c_{1}
$$
这是由于 $\Delta_{2k}<\Delta_{2k-2}< \cdots <\Delta_{0}$，利用 $l(x)$ 单调递减的形式，可得 $l (\Delta_{2k-2})>l (\Delta_{2k-4})>\cdots >l (\Delta_{0}) = c_{1}$。
因此，只要取 $k_{0} = \left[\dfrac{\Delta_{0} - x^{\star}}{c_{1} }\right]+1$，必然有 $\Delta_{2k} < x^{\star}$。方括号代表向上取整。

结合 （a），（b）两部分中的说明，我们得到两个情况：
- 若 $0<\Delta_{2k}<x^{\star}$，则必然有 $\Delta_{2k+1}<0$，即下一次小绿等待时，二者相遇
- 若 $\Delta_{2k}<0$，则根据 $\Delta_{2k}$ 与 $\Delta_{2k-1}$ 的关系，$\Delta_{2k-1}<0$，说明相遇已经在上一次小绿等待时发生。
刚才我们假设的是 $\Delta_{0}< x^{\dagger}$，如果 $\Delta_{0} > x^{\dagger}$，其实我们得到完全对称的情况，此时我们只要交换小红和小绿的身份就可以得到新的 $\Delta_{0}' = 1 - \Delta_{0}<x^{\dagger}$，于是我们又回到了上述情况。
综上，除了二者的初始相对距离 $\Delta_{0} = x^{\dagger}$ 的特殊情况，二者终将相遇。

（2）由给定的题设：
$$
y = f(\phi)  = \dfrac{1}{b} \ln(1 + (\exp(b)-1)\phi)
$$
它的反函数是：
$$
\phi = \dfrac{e^{by}-1}{e^{b}-1}
$$
由题目给定的公式得到：
$$
K(\phi) = (e^{b\epsilon} - 1)(\phi + \dfrac{1}{\exp(b)-1})
$$
我们对其进行小量近似，其中，我们认为 $b$ 和 $\epsilon$ 都是一阶小量，我们现在希望保留所有的一阶和二阶小量。我们进行如下的小量近似：
$$
\begin{align*}
K(\phi) &\approx b \epsilon(\phi + \dfrac{1}{\exp(b)-1})\\
&\approx b \epsilon [\phi + \dfrac{1}{b} \dfrac{1}{1+\dfrac{b}{2}}]\\
&\approx b \epsilon \phi + \epsilon(1 - \dfrac{b}{2})\\
&= b \epsilon \phi + \epsilon(1 - \dfrac{b}{2})
\end{align*}
$$
从而我们有（仍然沿用第一问中的定义）：
$$
\Delta_{2k+1}= \Delta_{2k} - b \epsilon(1 - \Delta_{0}) - \epsilon(1 - \dfrac{b}{2})
$$
以及：
$$
\begin{align*}
\Delta_{2k+2} &= \Delta_{2k+1} + b \epsilon\Delta_{2k+1} + \epsilon(1 - \dfrac{b}{2})\\
&\approx  \Delta_{2k}- b \epsilon (1 - \Delta_{2k}) - \epsilon\left(1 - \dfrac{b}{2}\right)+ b \epsilon \Delta_{2k} + \epsilon(1 - \dfrac{b}{2})\\
&= (1 + 2 b \epsilon)\Delta_{2k} - b \epsilon
\end{align*}
$$
从而我们又一次得到了递推数列。注意到我们可以将其变形为：
$$
\left(\Delta_{2k+2} - \dfrac{1}{2}\right)= (1 + 2 b \epsilon)(\Delta_{2k} - \dfrac{1}{2})
$$
推导得到：
$$
\Delta_{2k} = (1 + 2 b \epsilon)^{k}\left(\Delta_{0} - \dfrac{1}{2}\right)+ \dfrac{1}{2}
$$
令 $\Delta_{2k} = 0$，解得：
$$
k = \log_{1 + 2 b \epsilon} \dfrac{1}{1 - 2 \Delta_{0}}
$$
这就是相遇前所转圈数的估计值。其中，$\Delta_{0}$ 为初始时二者的相对距离，它的计算方法是：
$$
\Delta_{0} = \begin{cases}
|X(0) - Y(0)| \quad |X(0) - Y(0)| < 0.5  \\
1 - |X(0) - Y(0)| \quad |X(0) - Y(0)| \ge 0.5
\end{cases} 
$$
经编程验证，这个估计式在 $\Delta_{0}<0.48$ 时有 $20\%$ 之内的误差，这对于数量级来说足够了。
取某些参数的实验结果：
![[Pasted image 20240415024413.png]]
