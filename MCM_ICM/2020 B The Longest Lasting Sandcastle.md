---
banner: "![[banner7.png]]"
---
#MCM 

[[Commentary on 2020 B|裁判评价]]

## 2013836（可以封神）
**总模型：（三维）元胞自动机，将沙堡分成许多长方形元胞，模拟复杂系统随着时间的演化过程**
### STEP 0 准备工作：沙堡的生成
文章假设沙堡上面的方块不能在没有支持的情况下存在，因此文章采用了自下向上、逐渐收缩地沙堡生成方式：每一次都在下面的地基上盖一层新方块，并且新的方块的边界将比下面一层略微收缩。

![[Pasted image 20230204200956.png]]

作者定义变量 $s$（Gradient）来描述沙堡倾斜的程度，定义为
$$
S = \frac{n}{w}
$$
即沙堡的层数比上沙堡的总收缩量。由于每个方块的高度是相同的，因此叠的层数越高，沙堡也越高，$s$ 就表示了沙堡的倾斜程度。

### 准备工作：潮汐的描述

首先，我们知道，每天有两次高潮，两次低潮，潮汐变化可以近似使用正弦函数描述，娱乐海滩的开放时间是 6:00-24:00

![[Pasted image 20230204201445.png|500]]

接下来，建立描述海水速度变化的模型

![[Pasted image 20230204201727.png|500]]

如图，沙堡被放置在小倾角的海滩上，通过物理定律（列写波动方程，具体怎么做请看普通物理学课本）可以知道浅水波的波速是 $v = \sqrt{gh}$，那么假设海水可以完全浸透沙堡的底部，海水来和去时的波速就是
$$
v_1 = \sqrt{gh} \qquad v_2= \sqrt{g(h-l\sin \theta)}
$$
==由于水的速度是不断变化的，作者选择对沙堡的前面、后面计算一个平均速度，来作为前、后面感受到的真实海水速度，计算的方法是，先定义一个整体的平均速度
$$
\bar v = \frac{\sqrt{v_1^2+v_2^2}}{2}
$$
之后，前面和后面感受到的真实海水速度是
$$
\bar{v_1} = \frac{v_1+\bar v}{2} \qquad \bar{v_2} = \frac{v_2+\bar v}{2}
$$
个人认为，这一段作者可能是考虑到了沙堡在侵蚀中会逐渐变形，从而使得前面和后面移动。但是个人对于这种做法不太能够苟同（因为上面已经由太多近似，不知道这里为什么要再用一个奇怪的近似）。==

### STEP 1 : 元胞之间的内力描述

各个元胞之间内力产生的机理是：
- 水-沙比较低时，主要是沙子之间的摩擦力起作用
- 较高时，主要是水分子之间的电磁力起作用
然而，水分子之间的电磁力不能持续增大，在水-沙比例充分高的时候，混合物将变成流体。因此，作者构造了元胞间的内力与水-沙比的关系函数：

![[Pasted image 20230204205144.png|200]]

![[Pasted image 20230204205204.png|450]]

### STEP 2 : 沙堡的几个崩解模式

#### 局部梯度过高引起的崩解

对于任意一个元胞，定义其局部梯度为
$$
s'(x,y) = \max \{h(x,y) - h(x\pm1,y\pm1)\}
$$
（也就是衡量它高出了周围八个元胞的最高高度是多少）
当 $s'$ 达到一个临界值时，这个元胞就会崩解，临界值是多少与上面的内力大小有关

![[Pasted image 20230204210431.png|200]]

#### 海水冲刷引起的崩解

这一项效应用于描述沙堡中的元胞直接受到海水冲刷后的崩解。对于每一个元胞，其崩解的临界状态就是所有面上的相互作用力达到最大。作者根据方块所处的不同位置，划分了八个情况

![[Pasted image 20230204211640.png|400]]

使用 Case2 作为例子，作者的受力分析图如下：

![[Pasted image 20230204211940.png|300]]

这个冲击力 $F_i$ 是与方块的对角线共线的==（这应当是一个近似）==，只有水平向右的分力才可能将蓝色的方块拉出原位置，因此真正有效的力其实是冲击力的一个分量，又因为这个方块同时和其他三个方块接触，因此临界条件：
$$
\frac{\sqrt 2}{2}F_i>3f
$$
其余的方块可以照着做。

#### 方块浮起

对于使得方块浮起的作用力，作者考虑了两个：方块受到的浮力和方块上下表面的水流速度差造成的压力差，也就是
$$
F_{lift} = \frac{1}{2}\rho (v_u^2-v_d^2)S+\rho gV
$$ 
在这个力达到临界状态时，该方块会浮起

![[Pasted image 20230204213014.png|100]]

对于临界条件的定义，和上文差不多，比如 Case2 中研究的方块和另外两个方块相连，那么临界条件就是
$$
F_{lift}>2f+G
$$

#### 下雨的影响

由于下雨的影响甚至比海浪的冲击还要强，因此有必要把下雨的影响单独拿出来讨论。将所有方块划分成两类：
- 只有一面暴露在空气中的方块：不会被雨水冲走，但雨水会增加该方块的含水量
- 有两面暴露在空气中的方块：一旦碰到雨，立刻被冲走
此外，如果一个方块被海水击中，那么它的含水量增加一定值
$$
\Delta k = \alpha \exp(-k)
$$

### STEP 3：模型的验证和应用

#### 沙堡剩余方块数目随时间的变化

![[Pasted image 20230204220116.png|400]]

可以看到，倾斜程度最小的沙堡保留的比例最大，这与现实生活是十分符合的

#### 如何优化沙堡的形状（全文最妙的地方）

一些其他的文章可能会把沙堡堆成不同的初始形状，并进行对比。但是本文使用了一个迭代算法来寻找最优的形状
- 随机生成一个沙堡
- 进行一段时间的海水侵蚀模拟
- 生成一个和第一步中一样大的，但是横截面积和第二步结尾时沙堡一样的沙堡
- 转第二步，直到新生成的沙堡达到稳定为止

这样，就如同“物竞天择，适者生存”一样，最有利于沙堡留存的特征被保留下来。

![[Pasted image 20230204220955.png|400]]


#### 水沙比例：直接暴力搜索即可

![[Pasted image 20230204221114.png|400]]

**对于有降雨的情况，只要重复上述步骤即可。**




