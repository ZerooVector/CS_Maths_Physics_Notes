---
banner: "![[banner5.png]]"
---
#MLorDS 
# 自行阅读的部分
## 欧氏距离
欧氏距离是计算起来最容易的距离：设样本点为 $x$ 而查询点为 $q$，那么两点间的欧氏距离就定义为 $x-q$ 的 $L^2$ 范数:
$$
d(x,q) = ||x-q|| = \sqrt{(x-q)^T(x-q)}
$$
显然，与 $q$ 等距离的点，将分布在以 $q$ 为圆心，$d$ 为半径的正圆上。
![[Pasted image 20230223073042.png]]

## 标准化的欧氏距离
标准化的欧氏距离考虑了数据在每个维度上的标准差，它写成：
$$
d(x,q) = \sqrt{(x-q)^TD^{-1}D^{-1}(x-q)}
$$
其中，$D$ 是一个对角矩阵，$D = diag (\sigma_1,\sigma_2,\cdots,\sigma_n)$ ，那么，这个距离展开后，就可以写成:
$$
d(x,q) = \sqrt{\sum_{j=1}^D(\frac{x_j-q_j}{\sigma_j})^2}
$$
这个时候，等距离线已经变成了椭圆->椭球,...
![[Pasted image 20230223073855.png|500]]

显然，数据越分散的部分，等距离线就越宽。观察标准化欧氏距离的求解方法，它相当于以询问点 $q$ 为中心，先对数据执行中心化，再进行标准化。
![[Pasted image 20230223074125.png]]

## 最难理解的：马氏距离
欧氏距离考虑了数据的标准差，但是却没有考虑数据间的相关性。它写为：
$$
d(x,q) = \sqrt{(x-q)^T\Sigma^{-1}(x-q)}
$$
其中，协方差矩阵可以被特征值分解， $\Sigma = V\Lambda V^T$，因为 $\Sigma$ 是对称矩阵，因此分解后得到的 $V$ 应该是正交矩阵，因此，$\Sigma^{-1} = V\Gamma^{-1}V^T$。写进式子里，分配一下，就可以看到：
$$
d(x,q) = \sqrt{[\Lambda^{-1/2}V^T(x-q)]^T[\Lambda^{-1/2}V^T(x-q)]}
$$
由于 $V$ 是一个正交矩阵，那么 $V$ 实际上对数据进行了旋转，$\Lambda$ 进行了缩放，$x-q$ 则进行了中心化。
![[Pasted image 20230223075522.png]]

俗话说，远亲不如近邻——但是，即使近在咫尺，也可能形同陌路；即使天各一方，也会心有灵犀——欧氏距离不是决定两点之间相似度的唯一因素，数据本身在每个维度上的方差也会对距离产生影响。标准化的欧氏距离和马氏距离都在想方设法数据波动性带来的影响

## $L^1$ 范数：曼哈顿距离

## $L^{\infty}$ 范数：切比雪夫距离

![[Pasted image 20230223075956.png]]

切比雪夫距离就像是棋盘上的棋子移动一样——横着、竖着、斜着移动一格，都相当于走到了一格距离

## $L^p$ 范数：闵氏距离
![[Pasted image 20230223080121.png]]

## 余弦相似度
使用两个向量的余弦值直接作为它们的相似度，显然，余弦值越大，相似度也越高。
$$
k(x,q) = \frac{xq}{||x||\ ||q||}
$$
借助余弦相似度，我们可以直接定义“余弦距离“
$$
d(x,q) = 1-k(x,q)
$$
## 相关系数相似度
直接计算两个向量的 Pearson 相关系数
$$
k(x,q) = \frac{(x-\bar x)(q-\bar q)}{||x-\bar x||\ ||q-\bar q||}
$$
也可以定义相关系数距离
$$
d(x,q) = 1-k(x,q)
$$

## 核函数相似度
我们知道，如果 $x, q$ 都已经被标准化了，那么 $x, q$ 之间越相关，他们的内积应该越大。所有的和函数相似度几乎都是从这个思想衍生而来的。例如，线性核：
$$
k(x,q) = x^Tq
$$
Sigmoid 核：
$$
k(x,q) = \tanh(\gamma x^Tq+r)
$$
Gauss 核（径向基核函数）
$$
k(x,q) = \exp(-\gamma ||x-q||^2)
$$

Laplace 核：
$$
k(x,q) = exp(-\gamma||x-q||_1)
$$
## 成对距离 (相关) 矩阵：多个数据点 (特征) 之间距离 (相关性) 的可视化方式
![[Pasted image 20230223081714.png]]

可视化的时候，这张图还可以和系统聚类图联系起来
![[Pasted image 20230223081751.png|300]]

-- THE END--




# 上课讲授的部分
