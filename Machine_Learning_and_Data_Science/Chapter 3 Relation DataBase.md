#MLorDS 
## 关系模型的基本概念——概念的严谨数学定义
#### 关系的定义

- 域 (Domain)：具有相同类型的数据的值的集合称为 Domain，例如{男，女}
- 笛卡尔积（Cartesian Product）
- 元组：笛卡尔积中的每一个元素称为一个 $n$ 元组 ($n$ -tuple)
- 分量：元组中的每一个值叫做一个分量 (Component)

$D_1\times D_2\times \cdots \times D_n$ 称为 $D_1, D_2,\cdots,D_n$ 上的关系，$n$ 称为关系的度。一行是一个元组 $t$，一列是一个属性，我们可以这样索引：$t[A_i]$ 

在实际中，我们还需要对数学上的定义做出诸多限制。例如，实际的数据库中的关系必须是有限集合（数据库只能储存有限个关系）；由于笛卡尔积不满足交换律，但是我们可以交换关系的位置。我们通常使用一个属性名代表某一列，取消关系的有序性。因此，实际中的关系数据库可以满足如下的性质：
- 列是同质的
- 不同的列可以出自同一个域
- 列的顺序可任意交换
- 行的顺序可以交换
- 不允许出现相同的 tuple
- Component 不可再分

#### 关系模式和关系数据库
- 关系模式简是对关系的描述，记为关系名和属性名的组合，$R (A_1, A_2,\cdots,A_n)$
- 关系的值是元组的集合，是动态的，是填进去的数据，也可称为关系
- 关系模式和关系的值统称为关系
把关系模式加起来，就成了关系数据库模式；把所有的关系的值加起来，就成了关系数据库，其严格定义如下：
![[Pasted image 20230227140202.png|400]]

#### Key
设关系模式 $R$，$r$ 是 $R$ 上一个关系信息，$\forall t_1, t_2 \in r$，满足
- $t_1 [k]\not = t_2[k]$
- 不存在 $k$ 的真子集使得 $t_1 [k]\not = t_2[k]$ 成立

能当键的都叫候选键，选择其中一个叫主键；选择好几个叫联合键；全选叫全键

一个关系中的**一般属性，或者是组成键的部分属性 (这个可能很容易错）**，同时又是另一个关系的键，这样的属性称为外键。例如，班号是学生关系的外键，学号是学生选课关系的外键
![[Pasted image 20230227141208.png|400]]


#### 完整性约束
实体完整性和参照完整性由系统自动检查；用户自定义则被自定义
- 实体完整性：主键不能取空值！
- 参照完整性：
![[Chapter 3 Relation DataBase 2023-02-27 14.19.17.excalidraw|500]]
一张表是可以自己参照自己的，例如：
![[Pasted image 20230227142741.png|400]]

- 用户定义完整性

## 关系代数
### 传统的集合运算
#### 并 (Union)
![[Pasted image 20230227143250.png]]

#### 差 (Difference)
![[Pasted image 20230227143354.png]]

#### 交 (Intersection)
也可以表示成从 $R$ 中扣除 $S$ 中没有的元素
$$
R\cap S = R-(R-S)
$$
![[Pasted image 20230227143431.png]]

#### 笛卡尔积 (Cartesian Prod)
排列组合即可：
![[Pasted image 20230227143707.png|500]]

### 特殊的关系运算
记号引入：
- $t\in R$：$t$ 是 $R$ 中的元组
- $t[A_i]$ 是分量
- $A = \{A_{i1},A_{i2},\cdots\}$ 称为属性列
- $t[A]$ 表示元组 $t$ 在诸列上分量的集合
- $\bar A$ 是所有属性中去掉 $A$ 之后剩下的东西

#### 选择 (Selection)->选出特定的行
$$
\sigma_F(R) = \{t|t\in R \land t(F) \}
$$
![[Pasted image 20230227144343.png|350]]

#### 投影 (Projection)->选出特定的列
$$
\Pi_X(R) = \{t[x]|t \in R\}
$$
![[Pasted image 20230227144621.png|400]]

**注意：投影的过程中可能会使得某些行消失，这是因为你把主键拿掉之后，会出现很多重复的元组**
![[Pasted image 20230227144922.png|400]]

#### 连接 (Join)
- 条件连接
![[Pasted image 20230227145115.png|450]]

对于 $R$ 中的每一条元组，都尝试在 $S$ 中找到符合条件的元组进行连接
![[Pasted image 20230227145255.png|450]]

实际上，
![[Pasted image 20230227145342.png|300]]

- 自然连接

































