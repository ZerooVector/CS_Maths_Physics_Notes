#MLorDS 
## 基本思想
朴素贝叶斯的核心思想是比较后验概率的大小。例如，对于一个二分类问题，就是比较给定了数据点 $x$ 处，将该点分为两类的后验概率 $f_{Y|x}(C_1|x),f_{Y|x}(C_2|x)$ 的大小

## 数学知识补充
### 用一个特征来分类

我们先考虑条件概率的式子：
$$
P(B|A) = \frac{P(A,B)}{P(A)}
$$
这其实是缩小样本空间：在 $A$ 已经发生的条件下，再发生 $B$ 的概率，就是在 $A$ 已经发生的样本空间中，考虑 $A, B$ 同时发生的概率。
我们直接给出贝叶斯定理：
$$
f_{Y|X}(C_k|x) = \frac{f_{X,Y}(x,C_k)}{f_X(x)} = \frac{f_{X|Y}(x|C_k)p_Y(C_k)}{f_X(x)}
$$
这个式子的第一步就是条件概率展开；第二步是对第一步再用概率乘法定理展开，$p_Y(C_k)$ 称为先验概率，一般取集合中 $C_k$ 类样本占比作为先验概率。$f_{X|Y}(x|C_k)$ 称为似然概率，是给定 $C_k$ 类别后，特征 $x$ 出现的概率。$f_X (x)$ 称为证据因子，用来归一化。

我们直接来考虑各个变量连续的情况。
#### 似然概率
似然概率本身是条件概率，在离散变量的情况下，这个概率的计算显然是简单的。在连续的情况下，我们通常使用高斯核 KDE 对概率密度函数进行估计：
![[Pasted image 20230225135346.png|350]]

#### 先验概率
由于鸢尾花数据集中，共有 150 组数据，每个 50 组。所以，先验概率均为 $1/3$。
#### 联合概率
联合概率就是条件概率分子上的部分。依据概率乘法原理，它是似然概率和先验概率的乘积。
$$
f_{X,Y} = f_{X|Y}(x|C_k)p_Y(C_k)
$$
也就是说，联合概率是缩放过的似然。缩放的比例就是先验。
####  证据因子
证据因子是一个用来归一化的东西。因为，利用概率乘法定理：
$$
f_X(x) = \sum_i f_{X,Y}(x,C_k) = \sum_i f_{X|Y}(x|C_i)P_Y(C_i)
$$
他就是 $x$ 这个特征的密度分布。在 $x$ 取不同的值时，也取不同的值。联合概率比上证据因子就是在目前这个 $x$ 下，分到 $C_k$ 这一类的可能性，也就是我们要求的后验概率。
![[Pasted image 20230225140635.png|450]]

#### 后验概率——被分到每一类的“可能性”
后验概率是似然比证据因子。因为证据因子是三个似然加起来的，所以任何时候所有类别上后验概率的和都是 1.
分类依据就是比较后验概率的大小
![[Pasted image 20230225141018.png|400]]

另外一种估算似然概率的方法是基于正态分布。先估计正态分布的参数，再利用正态分布计算概率。
![[Pasted image 20230225141358.png|400]]


### 用两个特征来分类
#### 似然概率
两个特征同时出现的概率密度
![[Pasted image 20230225144150.png|300]]

#### 联合概率
根据概率乘法定理，显然联合概率等于似然概率乘以先验概率。那么联合概率的图就是把似然概率缩放一下。

#### 证据因子
和上面一样，把目前所有的联合概率加起来，联合概率除以证据因子就是分类可能性，也就是后验概率。

#### 后验概率
就是联合概率除以证据因子。（简单理解：第一类里有这个特征的除以目前所有类里有这个特征的，就是后验概率，也就是分到第一类的可能性）
![[Pasted image 20230225145301.png|350]]

### 问题的简化
#### 随机变量的独立
如果假设数据中的两个随机变量是独立的 (Sepal width, Sepal length)，那么它们的联合分布就是两个边缘分布的乘积：
$$
f_{X_1,X_2}(x_1,x_2) = f_{X_1}(x_1)\cdot f_{X_2}(x_2)
$$
和证据因子的曲面对比一下，这个假设下，差距太大，不好！
![[Pasted image 20230225145919.png|350]]

#### 随机变量的条件独立
也就是在给定 $Y = C_k$ 的条件下，假设 $X_1,X_2$ 独立：
$$
f_{X_1,X_2|Y}(x_1,x_2|C_k) = f_{x_1|Y}(x_1|C_k)\cdot f_{X_2|Y}(x_2|C_k)
$$
这个假设是比较好的。当然，在估算证据因子时，也需要用新的似然概率带进去。
